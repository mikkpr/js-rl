!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s=22)}([function(t,e,r){"use strict";const n=2.3283064365386963e-10;class i{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(t){return t=t<1?1/t:t,this._seed=t,this._s0=(t>>>0)*n,t=69069*t+1>>>0,this._s1=t*n,t=69069*t+1>>>0,this._s2=t*n,this._c=1,this}getUniform(){let t=2091639*this._s0+this._c*n;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2}getUniformInt(t,e){let r=Math.max(t,e),n=Math.min(t,e);return Math.floor(this.getUniform()*(r-n+1))+n}getNormal(t=0,e=1){let r,n,i;do{r=2*this.getUniform()-1,n=2*this.getUniform()-1,i=r*r+n*n}while(i>1||0==i);return t+r*Math.sqrt(-2*Math.log(i)/i)*e}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(t){return t.length?t[Math.floor(this.getUniform()*t.length)]:null}shuffle(t){let e=[],r=t.slice();for(;r.length;){let t=r.indexOf(this.getItem(r));e.push(r.splice(t,1)[0])}return e}getWeightedValue(t){let e=0;for(let r in t)e+=t[r];let r,n=this.getUniform()*e,i=0;for(r in t)if(i+=t[r],n<i)return r;return r}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(t){return this._s0=t[0],this._s1=t[1],this._s2=t[2],this._c=t[3],this}clone(){return(new i).setState(this.getState())}}e.a=(new i).setSeed(Date.now())},function(t,e,r){t.exports=r(15)},function(t,e,r){"use strict";function n(t,e){return(t%e+e)%e}function i(t,e=0,r=1){return t<e?e:t>r?r:t}function o(t){return t.charAt(0).toUpperCase()+t.substring(1)}function s(t,...e){let r=s.map;return t.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,(function(n,i,s,a){if("%"==t.charAt(a-1))return n.substring(1);if(!e.length)return n;let l=e[0],c=(i||s).split(","),h=c.shift()||"",u=r[h.toLowerCase()];if(!u)return n;l=e.shift();let f=l[u].apply(l,c),d=h.charAt(0);return d!=d.toLowerCase()&&(f=o(f)),f}))}r.r(e),r.d(e,"mod",(function(){return n})),r.d(e,"clamp",(function(){return i})),r.d(e,"capitalize",(function(){return o})),r.d(e,"format",(function(){return s})),s.map={s:"toString"}},function(t,e,r){"use strict";r.r(e),r.d(e,"fromString",(function(){return o})),r.d(e,"add",(function(){return s})),r.d(e,"add_",(function(){return a})),r.d(e,"multiply",(function(){return l})),r.d(e,"multiply_",(function(){return c})),r.d(e,"interpolate",(function(){return h})),r.d(e,"lerp",(function(){return u})),r.d(e,"interpolateHSL",(function(){return f})),r.d(e,"lerpHSL",(function(){return d})),r.d(e,"randomize",(function(){return _})),r.d(e,"rgb2hsl",(function(){return p})),r.d(e,"hsl2rgb",(function(){return m})),r.d(e,"toRGB",(function(){return v})),r.d(e,"toHex",(function(){return y}));var n=r(2),i=r(0);function o(t){let e,r;if(t in b)e=b[t];else{if("#"==t.charAt(0)){let r=(t.match(/[0-9a-f]/gi)||[]).map(t=>parseInt(t,16));if(3==r.length)e=r.map(t=>17*t);else{for(let t=0;t<3;t++)r[t+1]+=16*r[t],r.splice(t,1);e=r}}else e=(r=t.match(/rgb\(([0-9, ]+)\)/i))?r[1].split(/\s*,\s*/).map(t=>parseInt(t)):[0,0,0];b[t]=e}return e.slice()}function s(t,...e){let r=t.slice();for(let t=0;t<3;t++)for(let n=0;n<e.length;n++)r[t]+=e[n][t];return r}function a(t,...e){for(let r=0;r<3;r++)for(let n=0;n<e.length;n++)t[r]+=e[n][r];return t}function l(t,...e){let r=t.slice();for(let t=0;t<3;t++){for(let n=0;n<e.length;n++)r[t]*=e[n][t]/255;r[t]=Math.round(r[t])}return r}function c(t,...e){for(let r=0;r<3;r++){for(let n=0;n<e.length;n++)t[r]*=e[n][r]/255;t[r]=Math.round(t[r])}return t}function h(t,e,r=.5){let n=t.slice();for(let i=0;i<3;i++)n[i]=Math.round(n[i]+r*(e[i]-t[i]));return n}const u=h;function f(t,e,r=.5){let n=p(t),i=p(e);for(let t=0;t<3;t++)n[t]+=r*(i[t]-n[t]);return m(n)}const d=f;function _(t,e){e instanceof Array||(e=Math.round(i.a.getNormal(0,e)));let r=t.slice();for(let t=0;t<3;t++)r[t]+=e instanceof Array?Math.round(i.a.getNormal(0,e[t])):e;return r}function p(t){let e,r=t[0]/255,n=t[1]/255,i=t[2]/255,o=Math.max(r,n,i),s=Math.min(r,n,i),a=0,l=(o+s)/2;if(o==s)e=0;else{let t=o-s;switch(e=l>.5?t/(2-o-s):t/(o+s),o){case r:a=(n-i)/t+(n<i?6:0);break;case n:a=(i-r)/t+2;break;case i:a=(r-n)/t+4}a/=6}return[a,e,l]}function g(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function m(t){let e=t[2];if(0==t[1])return e=Math.round(255*e),[e,e,e];{let r=t[1],n=e<.5?e*(1+r):e+r-e*r,i=2*e-n,o=g(i,n,t[0]+1/3),s=g(i,n,t[0]),a=g(i,n,t[0]-1/3);return[Math.round(255*o),Math.round(255*s),Math.round(255*a)]}}function v(t){return`rgb(${t.map(t=>Object(n.clamp)(t,0,255)).join(",")})`}function y(t){return"#"+t.map(t=>Object(n.clamp)(t,0,255).toString(16).padStart(2,"0")).join("")}const b={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));class n{getContainer(){return null}setOptions(t){this._options=t}}},function(t,e){function r(t,e,r,n,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var s=t.apply(e,n);function a(t){r(s,i,o,a,l,"next",t)}function l(t){r(s,i,o,a,l,"throw",t)}a(void 0)}))}}},function(t,e){function r(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=r=function(t){return typeof t}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(e)}t.exports=r},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return s}));var n=r(4),i=r(3);function o(t){let e=i.fromString(t);return 36*Math.floor(e[0]*(6/256))+6*Math.floor(e[1]*(6/256))+1*Math.floor(e[2]*(6/256))+16}class s extends n.a{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(t){setTimeout(t,1e3/60)}setOptions(t){super.setOptions(t);let e=[t.width,t.height],r=this.computeSize();this._offset=r.map((t,r)=>Math.floor((t-e[r])/2))}clear(){t.stdout.write(`[0;48;5;${o(this._options.bg)}m[2J`)}draw(e,r){let[n,i,s,a,l]=e,c=this._offset[0]+n,h=this._offset[1]+i,u=this.computeSize();if(c<0||c>=u[0])return;if(h<0||h>=u[1])return;if(c===this._cursor[0]&&h===this._cursor[1]||(t.stdout.write(function(t,e){return`[${e+1};${t+1}H`}(c,h)),this._cursor[0]=c,this._cursor[1]=h),r&&(s||(s=" ")),!s)return;let f=function(t,e){return`[0;38;5;${o(t)};48;5;${o(e)}m`}(a,l);f!==this._lastColor&&(t.stdout.write(f),this._lastColor=f);let d=[].concat(s);t.stdout.write(d[0]),this._cursor[0]++,this._cursor[0]>=u[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(t,e){return[t,e]}computeSize(){return[t.stdout.columns,t.stdout.rows]}}}).call(this,r(16))},function(t,e,r){"use strict";(function(t,n){var i,o=r(13);i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:n;var s=Object(o.a)(i);e.a=s}).call(this,r(9),r(17)(t))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}},function(t,e){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e,r){(function(t){!function(e){"use strict";function r(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function n(t,e){Object.defineProperty(this,"kind",{value:t,enumerable:!0}),e&&e.length&&Object.defineProperty(this,"path",{value:e,enumerable:!0})}function i(t,e,r){i.super_.call(this,"E",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function o(t,e){o.super_.call(this,"N",t),Object.defineProperty(this,"rhs",{value:e,enumerable:!0})}function s(t,e){s.super_.call(this,"D",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0})}function a(t,e,r){a.super_.call(this,"A",t),Object.defineProperty(this,"index",{value:e,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function l(t,e,r){var n=t.slice((r||e)+1||t.length);return t.length=e<0?t.length+e:e,t.push.apply(t,n),t}function c(t){var e=void 0===t?"undefined":E(t);return"object"!==e?e:t===Math?"math":null===t?"null":Array.isArray(t)?"array":"[object Date]"===Object.prototype.toString.call(t)?"date":"function"==typeof t.toString&&/^\/.*\//.test(t.toString())?"regexp":"object"}function h(t,e,r,n,u,f,d){d=d||[];var _=(u=u||[]).slice(0);if(void 0!==f){if(n){if("function"==typeof n&&n(_,f))return;if("object"===(void 0===n?"undefined":E(n))){if(n.prefilter&&n.prefilter(_,f))return;if(n.normalize){var p=n.normalize(_,f,t,e);p&&(t=p[0],e=p[1])}}}_.push(f)}"regexp"===c(t)&&"regexp"===c(e)&&(t=t.toString(),e=e.toString());var g=void 0===t?"undefined":E(t),m=void 0===e?"undefined":E(e),v="undefined"!==g||d&&d[d.length-1].lhs&&d[d.length-1].lhs.hasOwnProperty(f),y="undefined"!==m||d&&d[d.length-1].rhs&&d[d.length-1].rhs.hasOwnProperty(f);if(!v&&y)r(new o(_,e));else if(!y&&v)r(new s(_,t));else if(c(t)!==c(e))r(new i(_,t,e));else if("date"===c(t)&&t-e!=0)r(new i(_,t,e));else if("object"===g&&null!==t&&null!==e)if(d.filter((function(e){return e.lhs===t})).length)t!==e&&r(new i(_,t,e));else{if(d.push({lhs:t,rhs:e}),Array.isArray(t)){var b;for(t.length,b=0;b<t.length;b++)b>=e.length?r(new a(_,b,new s(void 0,t[b]))):h(t[b],e[b],r,n,_,b,d);for(;b<e.length;)r(new a(_,b,new o(void 0,e[b++])))}else{var w=Object.keys(t),x=Object.keys(e);w.forEach((function(i,o){var s=x.indexOf(i);s>=0?(h(t[i],e[i],r,n,_,i,d),x=l(x,s)):h(t[i],void 0,r,n,_,i,d)})),x.forEach((function(t){h(void 0,e[t],r,n,_,t,d)}))}d.length=d.length-1}else t!==e&&("number"===g&&isNaN(t)&&isNaN(e)||r(new i(_,t,e)))}function u(t,e,r,n){return n=n||[],h(t,e,(function(t){t&&n.push(t)}),r),n.length?n:void 0}function f(t,e,r){if(t&&e&&r&&r.kind){for(var n=t,i=-1,o=r.path?r.path.length-1:0;++i<o;)void 0===n[r.path[i]]&&(n[r.path[i]]="number"==typeof r.path[i]?[]:{}),n=n[r.path[i]];switch(r.kind){case"A":!function t(e,r,n){if(n.path&&n.path.length){var i,o=e[r],s=n.path.length-1;for(i=0;i<s;i++)o=o[n.path[i]];switch(n.kind){case"A":t(o[n.path[i]],n.index,n.item);break;case"D":delete o[n.path[i]];break;case"E":case"N":o[n.path[i]]=n.rhs}}else switch(n.kind){case"A":t(e[r],n.index,n.item);break;case"D":e=l(e,r);break;case"E":case"N":e[r]=n.rhs}return e}(r.path?n[r.path[i]]:n,r.index,r.item);break;case"D":delete n[r.path[i]];break;case"E":case"N":n[r.path[i]]=r.rhs}}}function d(t){return"color: "+T[t].color+"; font-weight: bold"}function _(t,e,r,n){var i=u(t,e);try{n?r.groupCollapsed("diff"):r.group("diff")}catch(t){r.log("diff")}i?i.forEach((function(t){var e=t.kind,n=function(t){var e=t.kind,r=t.path,n=t.lhs,i=t.rhs,o=t.index,s=t.item;switch(e){case"E":return[r.join("."),n,"â†’",i];case"N":return[r.join("."),i];case"D":return[r.join(".")];case"A":return[r.join(".")+"["+o+"]",s];default:return[]}}(t);r.log.apply(r,["%c "+T[e].text,d(e)].concat(S(n)))})):r.log("â€”â€” no diff â€”â€”");try{r.groupEnd()}catch(t){r.log("â€”â€” diff end â€”â€” ")}}function p(t,e,r,n){switch(void 0===t?"undefined":E(t)){case"object":return"function"==typeof t[n]?t[n].apply(t,S(r)):t[n];case"function":return t(e);default:return t}}function g(t,e){var r=e.logger,n=e.actionTransformer,i=e.titleFormatter,o=void 0===i?function(t){var e=t.timestamp,r=t.duration;return function(t,n,i){var o=["action"];return o.push("%c"+String(t.type)),e&&o.push("%c@ "+n),r&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}(e):i,s=e.collapsed,a=e.colors,l=e.level,c=e.diff,h=void 0===e.titleFormatter;t.forEach((function(i,u){var f=i.started,d=i.startedTime,g=i.action,m=i.prevState,v=i.error,y=i.took,b=i.nextState,x=t[u+1];x&&(b=x.prevState,y=x.started-f);var E=n(g),S="function"==typeof s?s((function(){return b}),g,i):s,k=w(d),T=a.title?"color: "+a.title(E)+";":"",C=["color: gray; font-weight: lighter;"];C.push(T),e.timestamp&&C.push("color: gray; font-weight: lighter;"),e.duration&&C.push("color: gray; font-weight: lighter;");var O=o(E,k,y);try{S?a.title&&h?r.groupCollapsed.apply(r,["%c "+O].concat(C)):r.groupCollapsed(O):a.title&&h?r.group.apply(r,["%c "+O].concat(C)):r.group(O)}catch(t){r.log(O)}var A=p(l,E,[m],"prevState"),M=p(l,E,[E],"action"),K=p(l,E,[v,m],"error"),P=p(l,E,[b],"nextState");if(A)if(a.prevState){var V="color: "+a.prevState(m)+"; font-weight: bold";r[A]("%c prev state",V,m)}else r[A]("prev state",m);if(M)if(a.action){var R="color: "+a.action(E)+"; font-weight: bold";r[M]("%c action    ",R,E)}else r[M]("action    ",E);if(v&&K)if(a.error){var L="color: "+a.error(v,m)+"; font-weight: bold;";r[K]("%c error     ",L,v)}else r[K]("error     ",v);if(P)if(a.nextState){var j="color: "+a.nextState(b)+"; font-weight: bold";r[P]("%c next state",j,b)}else r[P]("next state",b);c&&_(m,b,r,S);try{r.groupEnd()}catch(t){r.log("â€”â€” log end â€”â€”")}}))}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},C,t),r=e.logger,n=e.stateTransformer,i=e.errorTransformer,o=e.predicate,s=e.logErrors,a=e.diffPredicate;if(void 0===r)return function(){return function(t){return function(e){return t(e)}}};if(t.getState&&t.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(t){return function(e){return t(e)}}};var l=[];return function(t){var r=t.getState;return function(t){return function(c){if("function"==typeof o&&!o(r,c))return t(c);var h={};l.push(h),h.started=x.now(),h.startedTime=new Date,h.prevState=n(r()),h.action=c;var u=void 0;if(s)try{u=t(c)}catch(t){h.error=i(t)}else u=t(c);h.took=x.now()-h.started,h.nextState=n(r());var f=e.diff&&"function"==typeof a?a(r,c):e.diff;if(g(l,Object.assign({},e,{diff:f})),l.length=0,h.error)throw h.error;return u}}}}var v,y,b=function(t,e){return function(t,e){return new Array(e+1).join(t)}("0",e-t.toString().length)+t},w=function(t){return b(t.getHours(),2)+":"+b(t.getMinutes(),2)+":"+b(t.getSeconds(),2)+"."+b(t.getMilliseconds(),3)},x="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},k=[];v="object"===(void 0===t?"undefined":E(t))&&t?t:"undefined"!=typeof window?window:{},(y=v.DeepDiff)&&k.push((function(){void 0!==y&&v.DeepDiff===u&&(v.DeepDiff=y,y=void 0)})),r(i,n),r(o,n),r(s,n),r(a,n),Object.defineProperties(u,{diff:{value:u,enumerable:!0},observableDiff:{value:h,enumerable:!0},applyDiff:{value:function(t,e,r){t&&e&&h(t,e,(function(n){r&&!r(t,e,n)||f(t,e,n)}))},enumerable:!0},applyChange:{value:f,enumerable:!0},revertChange:{value:function(t,e,r){if(t&&e&&r&&r.kind){var n,i,o=t;for(i=r.path.length-1,n=0;n<i;n++)void 0===o[r.path[n]]&&(o[r.path[n]]={}),o=o[r.path[n]];switch(r.kind){case"A":!function t(e,r,n){if(n.path&&n.path.length){var i,o=e[r],s=n.path.length-1;for(i=0;i<s;i++)o=o[n.path[i]];switch(n.kind){case"A":t(o[n.path[i]],n.index,n.item);break;case"D":case"E":o[n.path[i]]=n.lhs;break;case"N":delete o[n.path[i]]}}else switch(n.kind){case"A":t(e[r],n.index,n.item);break;case"D":case"E":e[r]=n.lhs;break;case"N":e=l(e,r)}return e}(o[r.path[n]],r.index,r.item);break;case"D":case"E":o[r.path[n]]=r.lhs;break;case"N":delete o[r.path[n]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==y},enumerable:!0},noConflict:{value:function(){return k&&(k.forEach((function(t){t()})),k=null),u},enumerable:!0}});var T={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},C={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(t){return t},actionTransformer:function(t){return t},errorTransformer:function(t){return t},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},O=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dispatch,r=t.getState;return"function"==typeof e||"function"==typeof r?m()({dispatch:e,getState:r}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=C,e.createLogger=m,e.logger=O,e.default=O,Object.defineProperty(e,"__esModule",{value:!0})}(e)}).call(this,r(9))},function(t,e,r){"use strict";function n(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}r.d(e,"a",(function(){return n}))},function(t,e,r){var n=r(18),i=r(19),o=r(20),s=r(21);t.exports=function(t){return n(t)||i(t)||o(t)||s()}},function(t,e,r){var n=function(t){"use strict";var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function a(t,e,r,n){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),s=new x(n||[]);return o._invoke=function(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return S()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=y(s,r);if(a){if(a===c)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var h=l(t,e,r);if("normal"===h.type){if(n=r.done?"completed":"suspendedYield",h.arg===c)continue;return{value:h.arg,done:r.done}}"throw"===h.type&&(n="completed",r.method="throw",r.arg=h.arg)}}}(t,r,s),o}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=a;var c={};function h(){}function u(){}function f(){}var d={};d[i]=function(){return this};var _=Object.getPrototypeOf,p=_&&_(_(E([])));p&&p!==e&&r.call(p,i)&&(d=p);var g=f.prototype=h.prototype=Object.create(d);function m(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function v(t,e){var n;this._invoke=function(i,o){function s(){return new e((function(n,s){!function n(i,o,s,a){var c=l(t[i],t,o);if("throw"!==c.type){var h=c.arg,u=h.value;return u&&"object"==typeof u&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(u).then((function(t){h.value=t,s(h)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}(i,o,n,s)}))}return n=n?n.then(s,s):s()}}function y(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,y(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,c;var i=n.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return u.prototype=g.constructor=f,f.constructor=u,f[s]=u.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===u||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(v.prototype),v.prototype[o]=function(){return this},t.AsyncIterator=v,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new v(a(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},m(g),g[s]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=E,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return s.type="throw",s.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;w(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:E(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var l,c=[],h=!1,u=-1;function f(){h&&l&&(h=!1,l.length?c=l.concat(c):u=-1,c.length&&d())}function d(){if(!h){var t=a(f);h=!0;for(var e=c.length;e;){for(l=c,c=[];++u<e;)l&&l[u].run();u=-1,e=c.length}l=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function _(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new _(t,e)),1!==c.length||h||a(d)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,r){var n=r(10);t.exports=function(t){if(Array.isArray(t))return n(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e,r){var n=r(10);t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,r){"use strict";r.r(e),r.d(e,"display",(function(){return kr}));var n={};r.r(n),r.d(n,"TYPE_TEXT",(function(){return k})),r.d(n,"TYPE_NEWLINE",(function(){return T})),r.d(n,"TYPE_FG",(function(){return C})),r.d(n,"TYPE_BG",(function(){return O})),r.d(n,"measure",(function(){return A})),r.d(n,"tokenize",(function(){return M}));var i={};r.r(i),r.d(i,"RNG",(function(){return c.a})),r.d(i,"Display",(function(){return D})),r.d(i,"StringGenerator",(function(){return I})),r.d(i,"EventQueue",(function(){return U})),r.d(i,"Scheduler",(function(){return W})),r.d(i,"FOV",(function(){return X})),r.d(i,"Map",(function(){return tt})),r.d(i,"Noise",(function(){return nt})),r.d(i,"Path",(function(){return ot})),r.d(i,"Engine",(function(){return st})),r.d(i,"Lighting",(function(){return at})),r.d(i,"DEFAULT_WIDTH",(function(){return P})),r.d(i,"DEFAULT_HEIGHT",(function(){return V})),r.d(i,"DIRS",(function(){return R})),r.d(i,"KEYS",(function(){return L})),r.d(i,"Util",(function(){return lt})),r.d(i,"Color",(function(){return ct})),r.d(i,"Text",(function(){return ht}));var o=r(1),s=r.n(o),a=r(5),l=r.n(a),c=r(0),h=r(4);class u extends h.a{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(t){requestAnimationFrame(t)}getContainer(){return this._ctx.canvas}setOptions(t){super.setOptions(t);const e=`${t.fontStyle?t.fontStyle+" ":""} ${t.fontSize}px ${t.fontFamily}`;this._ctx.font=e,this._updateSize(),this._ctx.font=e,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(t,e){let r=this._ctx.canvas,n=r.getBoundingClientRect();return t-=n.left,e-=n.top,t*=r.width/n.width,e*=r.height/n.height,t<0||e<0||t>=r.width||e>=r.height?[-1,-1]:this._normalizedEventToPosition(t,e)}}var f=r(2);class d extends u{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(t,e){let[r,n,i,o,s]=t,a=[(r+1)*this._spacingX,n*this._spacingY+this._hexSize];if(this._options.transpose&&a.reverse(),e&&(this._ctx.fillStyle=s,this._fill(a[0],a[1])),!i)return;this._ctx.fillStyle=o;let l=[].concat(i);for(let t=0;t<l.length;t++)this._ctx.fillText(l[t],a[0],Math.ceil(a[1]))}computeSize(t,e){return this._options.transpose&&(t+=e,t-=e=t-e),[Math.floor(t/this._spacingX)-1,Math.floor((e-2*this._hexSize)/this._spacingY+1)]}computeFontSize(t,e){this._options.transpose&&(t+=e,t-=e=t-e);let r=2*t/((this._options.width+1)*Math.sqrt(3))-1,n=e/(2+1.5*(this._options.height-1)),i=Math.min(r,n),o=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let s=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=o;let a=s/100;i=Math.floor(i)+1;let l=2*i/(this._options.spacing*(1+a/Math.sqrt(3)));return Math.ceil(l)-1}_normalizedEventToPosition(t,e){let r;this._options.transpose?(t+=e,t-=e=t-e,r=this._ctx.canvas.width):r=this._ctx.canvas.height;let n=r/this._options.height;return e=Math.floor(e/n),Object(f.mod)(e,2)?(t-=this._spacingX,t=1+2*Math.floor(t/(2*this._spacingX))):t=2*Math.floor(t/(2*this._spacingX)),[t,e]}_fill(t,e){let r=this._hexSize,n=this._options.border;const i=this._ctx;i.beginPath(),this._options.transpose?(i.moveTo(t-r+n,e),i.lineTo(t-r/2+n,e+this._spacingX-n),i.lineTo(t+r/2-n,e+this._spacingX-n),i.lineTo(t+r-n,e),i.lineTo(t+r/2-n,e-this._spacingX+n),i.lineTo(t-r/2+n,e-this._spacingX+n),i.lineTo(t-r+n,e)):(i.moveTo(t,e-r+n),i.lineTo(t+this._spacingX-n,e-r/2+n),i.lineTo(t+this._spacingX-n,e+r/2-n),i.lineTo(t,e+r-n),i.lineTo(t-this._spacingX+n,e+r/2-n),i.lineTo(t-this._spacingX+n,e-r/2+n),i.lineTo(t,e-r+n)),i.fill()}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);let r,n;this._hexSize=Math.floor(t.spacing*(t.fontSize+e/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,t.transpose?(r="height",n="width"):(r="width",n="height"),this._ctx.canvas[r]=Math.ceil((t.width+1)*this._spacingX),this._ctx.canvas[n]=Math.ceil((t.height-1)*this._spacingY+2*this._hexSize)}}class _ extends u{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(t){super.setOptions(t),this._canvasCache={}}draw(t,e){_.cache?this._drawWithCache(t):this._drawNoCache(t,e)}_drawWithCache(t){let e,[r,n,i,o,s]=t,a=""+i+o+s;if(a in this._canvasCache)e=this._canvasCache[a];else{let t=this._options.border;e=document.createElement("canvas");let r=e.getContext("2d");if(e.width=this._spacingX,e.height=this._spacingY,r.fillStyle=s,r.fillRect(t,t,e.width-t,e.height-t),i){r.fillStyle=o,r.font=this._ctx.font,r.textAlign="center",r.textBaseline="middle";let t=[].concat(i);for(let e=0;e<t.length;e++)r.fillText(t[e],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[a]=e}this._ctx.drawImage(e,r*this._spacingX,n*this._spacingY)}_drawNoCache(t,e){let[r,n,i,o,s]=t;if(e){let t=this._options.border;this._ctx.fillStyle=s,this._ctx.fillRect(r*this._spacingX+t,n*this._spacingY+t,this._spacingX-t,this._spacingY-t)}if(!i)return;this._ctx.fillStyle=o;let a=[].concat(i);for(let t=0;t<a.length;t++)this._ctx.fillText(a[t],(r+.5)*this._spacingX,Math.ceil((n+.5)*this._spacingY))}computeSize(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}computeFontSize(t,e){let r=Math.floor(t/this._options.width),n=Math.floor(e/this._options.height),i=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=i;let s=o/100*n/r;return s>1&&(n=Math.floor(n/s)),Math.floor(n/this._options.spacing)}_normalizedEventToPosition(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(t.spacing*e),this._spacingY=Math.ceil(t.spacing*t.fontSize),t.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=t.width*this._spacingX,this._ctx.canvas.height=t.height*this._spacingY}}_.cache=!1;class p extends u{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(t,e){let[r,n,i,o,s]=t,a=this._options.tileWidth,l=this._options.tileHeight;if(e&&(this._options.tileColorize?this._ctx.clearRect(r*a,n*l,a,l):(this._ctx.fillStyle=s,this._ctx.fillRect(r*a,n*l,a,l))),!i)return;let c=[].concat(i),h=[].concat(o),u=[].concat(s);for(let t=0;t<c.length;t++){let e=this._options.tileMap[c[t]];if(!e)throw new Error(`Char "${c[t]}" not found in tileMap`);if(this._options.tileColorize){let i=this._colorCanvas,o=i.getContext("2d");o.globalCompositeOperation="source-over",o.clearRect(0,0,a,l);let s=h[t],c=u[t];o.drawImage(this._options.tileSet,e[0],e[1],a,l,0,0,a,l),"transparent"!=s&&(o.fillStyle=s,o.globalCompositeOperation="source-atop",o.fillRect(0,0,a,l)),"transparent"!=c&&(o.fillStyle=c,o.globalCompositeOperation="destination-over",o.fillRect(0,0,a,l)),this._ctx.drawImage(i,r*a,n*l,a,l)}else this._ctx.drawImage(this._options.tileSet,e[0],e[1],a,l,r*a,n*l,a,l)}}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._options;this._ctx.canvas.width=t.width*t.tileWidth,this._ctx.canvas.height=t.height*t.tileHeight,this._colorCanvas.width=t.tileWidth,this._colorCanvas.height=t.tileHeight}}var g=r(3);class m extends h.a{static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(t){alert(t.message)}}schedule(t){requestAnimationFrame(t)}getContainer(){return this._gl.canvas}setOptions(t){super.setOptions(t),this._updateSize();let e=this._options.tileSet;e&&"complete"in e&&!e.complete?e.addEventListener("load",()=>this._updateTexture(e)):this._updateTexture(e)}draw(t,e){const r=this._gl,n=this._options;let[i,o,s,a,l]=t,c=r.canvas.height-(o+1)*n.tileHeight;if(r.scissor(i*n.tileWidth,c,n.tileWidth,n.tileHeight),e&&(n.tileColorize?r.clearColor(0,0,0,0):r.clearColor(...x(l)),r.clear(r.COLOR_BUFFER_BIT)),!s)return;let h=[].concat(s),u=[].concat(l),f=[].concat(a);r.uniform2fv(this._uniforms.targetPosRel,[i,o]);for(let t=0;t<h.length;t++){let e=this._options.tileMap[h[t]];if(!e)throw new Error(`Char "${h[t]}" not found in tileMap`);r.uniform1f(this._uniforms.colorize,n.tileColorize?1:0),r.uniform2fv(this._uniforms.tilesetPosAbs,e),n.tileColorize&&(r.uniform4fv(this._uniforms.tint,x(f[t])),r.uniform4fv(this._uniforms.bg,x(u[t]))),r.drawArrays(r.TRIANGLE_STRIP,0,4)}}clear(){const t=this._gl;t.clearColor(...x(this._options.bg)),t.scissor(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(t,e){let r=this._gl.canvas,n=r.getBoundingClientRect();return t-=n.left,e-=n.top,t*=r.width/n.width,e*=r.height/n.height,t<0||e<0||t>=r.width||e>=r.height?[-1,-1]:this._normalizedEventToPosition(t,e)}_initWebGL(){let t=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=t;let e=function(t,e,r){const n=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n)||"");const i=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(i,r),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(i)||"");const o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(o)||"");return o}(t,y,b);return t.useProgram(e),function(t){const e=new Float32Array([0,0,1,0,0,1,1,1]),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0)}(t),v.forEach(r=>this._uniforms[r]=t.getUniformLocation(e,r)),this._program=e,t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.SCISSOR_TEST),t}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._gl,e=this._options,r=[e.width*e.tileWidth,e.height*e.tileHeight];t.canvas.width=r[0],t.canvas.height=r[1],t.viewport(0,0,r[0],r[1]),t.uniform2fv(this._uniforms.tileSize,[e.tileWidth,e.tileHeight]),t.uniform2fv(this._uniforms.targetSize,r)}_updateTexture(t){!function(t,e){let r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}(this._gl,t)}}const v=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],y="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),b="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();let w={};function x(t){if(!(t in w)){let e;if("transparent"==t)e=[0,0,0,0];else if(t.indexOf("rgba")>-1){e=(t.match(/[\d.]+/g)||[]).map(Number);for(let t=0;t<3;t++)e[t]=e[t]/255}else e=g.fromString(t).map(t=>t/255),e.push(1);w[t]=e}return w[t]}var E=r(7);const S=/%([bc]){([^}]*)}/g,k=0,T=1,C=2,O=3;function A(t,e){let r={width:0,height:1},n=M(t,e),i=0;for(let t=0;t<n.length;t++){let e=n[t];switch(e.type){case k:i+=e.value.length;break;case T:r.height++,r.width=Math.max(r.width,i),i=0}}return r.width=Math.max(r.width,i),r}function M(t,e){let r=[],n=0;t.replace(S,(function(e,i,o,s){let a=t.substring(n,s);return a.length&&r.push({type:k,value:a}),r.push({type:"c"==i?C:O,value:o.trim()}),n=s+e.length,""}));let i=t.substring(n);return i.length&&r.push({type:k,value:i}),function(t,e){e||(e=1/0);let r=0,n=0,i=-1;for(;r<t.length;){let o=t[r];if(o.type==T&&(n=0,i=-1),o.type!=k){r++;continue}for(;0==n&&" "==o.value.charAt(0);)o.value=o.value.substring(1);let s=o.value.indexOf("\n");if(-1!=s){o.value=K(t,r,s,!0);let e=o.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();o.value=e.join("")}if(o.value.length){if(n+o.value.length>e){let s=-1;for(;;){let t=o.value.indexOf(" ",s+1);if(-1==t)break;if(n+t>e)break;s=t}if(-1!=s)o.value=K(t,r,s,!0);else if(-1!=i){let e=t[i],n=e.value.lastIndexOf(" ");e.value=K(t,i,n,!0),r=i}else o.value=K(t,r,e-n,!1)}else n+=o.value.length,-1!=o.value.indexOf(" ")&&(i=r);r++}else t.splice(r,1)}t.push({type:T});let o=null;for(let e=0;e<t.length;e++){let r=t[e];switch(r.type){case k:o=r;break;case T:if(o){let t=o.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();o.value=t.join("")}o=null}}return t.pop(),t}(r,e)}function K(t,e,r,n){let i={type:T},o={type:k,value:t[e].value.substring(r+(n?1:0))};return t.splice(e+1,0,i,o),t[e].value.substring(0,r)}let P=80,V=25;const R={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},L={VK_CANCEL:3,VK_HELP:6,VK_BACK_SPACE:8,VK_TAB:9,VK_CLEAR:12,VK_RETURN:13,VK_ENTER:14,VK_SHIFT:16,VK_CONTROL:17,VK_ALT:18,VK_PAUSE:19,VK_CAPS_LOCK:20,VK_ESCAPE:27,VK_SPACE:32,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_PRINTSCREEN:44,VK_INSERT:45,VK_DELETE:46,VK_0:48,VK_1:49,VK_2:50,VK_3:51,VK_4:52,VK_5:53,VK_6:54,VK_7:55,VK_8:56,VK_9:57,VK_COLON:58,VK_SEMICOLON:59,VK_LESS_THAN:60,VK_EQUALS:61,VK_GREATER_THAN:62,VK_QUESTION_MARK:63,VK_AT:64,VK_A:65,VK_B:66,VK_C:67,VK_D:68,VK_E:69,VK_F:70,VK_G:71,VK_H:72,VK_I:73,VK_J:74,VK_K:75,VK_L:76,VK_M:77,VK_N:78,VK_O:79,VK_P:80,VK_Q:81,VK_R:82,VK_S:83,VK_T:84,VK_U:85,VK_V:86,VK_W:87,VK_X:88,VK_Y:89,VK_Z:90,VK_CONTEXT_MENU:93,VK_NUMPAD0:96,VK_NUMPAD1:97,VK_NUMPAD2:98,VK_NUMPAD3:99,VK_NUMPAD4:100,VK_NUMPAD5:101,VK_NUMPAD6:102,VK_NUMPAD7:103,VK_NUMPAD8:104,VK_NUMPAD9:105,VK_MULTIPLY:106,VK_ADD:107,VK_SEPARATOR:108,VK_SUBTRACT:109,VK_DECIMAL:110,VK_DIVIDE:111,VK_F1:112,VK_F2:113,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_F10:121,VK_F11:122,VK_F12:123,VK_F13:124,VK_F14:125,VK_F15:126,VK_F16:127,VK_F17:128,VK_F18:129,VK_F19:130,VK_F20:131,VK_F21:132,VK_F22:133,VK_F23:134,VK_F24:135,VK_NUM_LOCK:144,VK_SCROLL_LOCK:145,VK_CIRCUMFLEX:160,VK_EXCLAMATION:161,VK_DOUBLE_QUOTE:162,VK_HASH:163,VK_DOLLAR:164,VK_PERCENT:165,VK_AMPERSAND:166,VK_UNDERSCORE:167,VK_OPEN_PAREN:168,VK_CLOSE_PAREN:169,VK_ASTERISK:170,VK_PLUS:171,VK_PIPE:172,VK_HYPHEN_MINUS:173,VK_OPEN_CURLY_BRACKET:174,VK_CLOSE_CURLY_BRACKET:175,VK_TILDE:176,VK_COMMA:188,VK_PERIOD:190,VK_SLASH:191,VK_BACK_QUOTE:192,VK_OPEN_BRACKET:219,VK_BACK_SLASH:220,VK_CLOSE_BRACKET:221,VK_QUOTE:222,VK_META:224,VK_ALTGR:225,VK_WIN:91,VK_KANA:21,VK_HANGUL:21,VK_EISU:22,VK_JUNJA:23,VK_FINAL:24,VK_HANJA:25,VK_KANJI:25,VK_CONVERT:28,VK_NONCONVERT:29,VK_ACCEPT:30,VK_MODECHANGE:31,VK_SELECT:41,VK_PRINT:42,VK_EXECUTE:43,VK_SLEEP:95},j={hex:d,rect:_,tile:p,"tile-gl":m,term:E.a},N={width:P,height:V,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};class D{constructor(t={}){this._data={},this._dirty=!1,this._options={},t=Object.assign({},N,t),this.setOptions(t),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(t,e,r){let n=[this._options.bg,this._options.fg];this.draw(t,e,null,null,n[r%n.length])}clear(){this._data={},this._dirty=!0}setOptions(t){if(Object.assign(this._options,t),t.width||t.height||t.fontSize||t.fontFamily||t.spacing||t.layout){if(t.layout){let e=j[t.layout];this._backend=new e}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(t,e){return this._backend.computeSize(t,e)}computeFontSize(t,e){return this._backend.computeFontSize(t,e)}computeTileSize(t,e){return[Math.floor(t/this._options.width),Math.floor(e/this._options.height)]}eventToPosition(t){let e,r;return"touches"in t?(e=t.touches[0].clientX,r=t.touches[0].clientY):(e=t.clientX,r=t.clientY),this._backend.eventToPosition(e,r)}draw(t,e,r,n,i){n||(n=this._options.fg),i||(i=this._options.bg);let o=`${t},${e}`;this._data[o]=[t,e,r,n,i],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[o]=!0)}drawText(t,e,r,n){let i=null,o=null,s=t,a=e,l=1;n||(n=this._options.width-t);let c=M(r,n);for(;c.length;){let e=c.shift();switch(e.type){case k:let r=!1,n=!1,c=!1,h=!1;for(let t=0;t<e.value.length;t++){let l=e.value.charCodeAt(t),u=e.value.charAt(t);c=l>65280&&l<65377||l>65500&&l<65512||l>65518,r=32==u.charCodeAt(0)||12288==u.charCodeAt(0),!h||c||r||s++,c&&!n&&s++,this.draw(s++,a,u,i,o),n=r,h=c}break;case C:i=e.value||null;break;case O:o=e.value||null;break;case T:s=t,a++,l++}}return l}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty){this._backend.clear();for(let t in this._data)this._draw(t,!1)}else for(let t in this._dirty)this._draw(t,!0);this._dirty=!1}}_draw(t,e){let r=this._data[t];r[4]!=this._options.bg&&(e=!0),this._backend.draw(r,e)}}D.Rect=_,D.Hex=d,D.Tile=p,D.TileGL=m,D.Term=E.a;class I{constructor(t){this._options={words:!1,order:3,prior:.001},Object.assign(this._options,t),this._boundary=String.fromCharCode(0),this._suffix=this._boundary,this._prefix=[];for(let t=0;t<this._options.order;t++)this._prefix.push(this._boundary);this._priorValues={},this._priorValues[this._boundary]=this._options.prior,this._data={}}clear(){this._data={},this._priorValues={}}generate(){let t=[this._sample(this._prefix)];for(;t[t.length-1]!=this._boundary;)t.push(this._sample(t));return this._join(t.slice(0,-1))}observe(t){let e=this._split(t);for(let t=0;t<e.length;t++)this._priorValues[e[t]]=this._options.prior;e=this._prefix.concat(e).concat(this._suffix);for(let t=this._options.order;t<e.length;t++){let r=e.slice(t-this._options.order,t),n=e[t];for(let t=0;t<r.length;t++){let e=r.slice(t);this._observeEvent(e,n)}}}getStats(){let t=[],e=Object.keys(this._priorValues).length;e--,t.push("distinct samples: "+e);let r=Object.keys(this._data).length,n=0;for(let t in this._data)n+=Object.keys(this._data[t]).length;return t.push("dictionary size (contexts): "+r),t.push("dictionary size (events): "+n),t.join(", ")}_split(t){return t.split(this._options.words?/\s+/:"")}_join(t){return t.join(this._options.words?" ":"")}_observeEvent(t,e){let r=this._join(t);r in this._data||(this._data[r]={});let n=this._data[r];e in n||(n[e]=0),n[e]++}_sample(t){t=this._backoff(t);let e=this._join(t),r=this._data[e],n={};if(this._options.prior){for(let t in this._priorValues)n[t]=this._priorValues[t];for(let t in r)n[t]+=r[t]}else n=r;return c.a.getWeightedValue(n)}_backoff(t){for(t.length>this._options.order?t=t.slice(-this._options.order):t.length<this._options.order&&(t=this._prefix.slice(0,this._options.order-t.length).concat(t));!(this._join(t)in this._data)&&t.length>0;)t=t.slice(1);return t}}class U{constructor(){this._time=0,this._events=[],this._eventTimes=[]}getTime(){return this._time}clear(){return this._events=[],this._eventTimes=[],this}add(t,e){let r=this._events.length;for(let t=0;t<this._eventTimes.length;t++)if(this._eventTimes[t]>e){r=t;break}this._events.splice(r,0,t),this._eventTimes.splice(r,0,e)}get(){if(!this._events.length)return null;let t=this._eventTimes.splice(0,1)[0];if(t>0){this._time+=t;for(let e=0;e<this._eventTimes.length;e++)this._eventTimes[e]-=t}return this._events.splice(0,1)[0]}getEventTime(t){let e=this._events.indexOf(t);if(-1!=e)return this._eventTimes[e]}remove(t){let e=this._events.indexOf(t);return-1!=e&&(this._remove(e),!0)}_remove(t){this._events.splice(t,1),this._eventTimes.splice(t,1)}}class F{constructor(){this._queue=new U,this._repeat=[],this._current=null}getTime(){return this._queue.getTime()}add(t,e){return e&&this._repeat.push(t),this}getTimeOf(t){return this._queue.getEventTime(t)}clear(){return this._queue.clear(),this._repeat=[],this._current=null,this}remove(t){let e=this._queue.remove(t),r=this._repeat.indexOf(t);return-1!=r&&this._repeat.splice(r,1),this._current==t&&(this._current=null),e}next(){return this._current=this._queue.get(),this._current}}var W={Simple:class extends F{add(t,e){return this._queue.add(t,0),super.add(t,e)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,0),super.next()}},Speed:class extends F{add(t,e,r){return this._queue.add(t,void 0!==r?r:1/t.getSpeed()),super.add(t,e)}next(){return this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,1/this._current.getSpeed()),super.next()}},Action:class extends F{constructor(){super(),this._defaultDuration=1,this._duration=this._defaultDuration}add(t,e,r){return this._queue.add(t,r||this._defaultDuration),super.add(t,e)}clear(){return this._duration=this._defaultDuration,super.clear()}remove(t){return t==this._current&&(this._duration=this._defaultDuration),super.remove(t)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&(this._queue.add(this._current,this._duration||this._defaultDuration),this._duration=this._defaultDuration),super.next()}setDuration(t){return this._current&&(this._duration=t),this}}};class z{constructor(t,e={}){this._lightPasses=t,this._options=Object.assign({topology:8},e)}_getCircle(t,e,r){let n,i,o,s=[];switch(this._options.topology){case 4:i=1,o=[0,1],n=[R[8][7],R[8][1],R[8][3],R[8][5]];break;case 6:n=R[6],i=1,o=[-1,1];break;case 8:n=R[4],i=2,o=[-1,1];break;default:throw new Error("Incorrect topology for FOV computation")}let a=t+o[0]*r,l=e+o[1]*r;for(let t=0;t<n.length;t++)for(let e=0;e<r*i;e++)s.push([a,l]),a+=n[t][0],l+=n[t][1];return s}}const H=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]];var X={DiscreteShadowcasting:class extends z{compute(t,e,r,n){if(n(t,e,0,1),!this._lightPasses(t,e))return;let i,o,s,a,l,c=[];for(let h=1;h<=r;h++){let r=this._getCircle(t,e,h),u=360/r.length;for(let t=0;t<r.length;t++)if(s=r[t][0],a=r[t][1],i=u*(t-.5),o=i+u,l=!this._lightPasses(s,a),this._visibleCoords(Math.floor(i),Math.ceil(o),l,c)&&n(s,a,h,1),2==c.length&&0==c[0]&&360==c[1])return}}_visibleCoords(t,e,r,n){if(t<0){let i=this._visibleCoords(0,e,r,n),o=this._visibleCoords(360+t,360,r,n);return i||o}let i=0;for(;i<n.length&&n[i]<t;)i++;if(i==n.length)return r&&n.push(t,e),!0;let o=0;if(i%2){for(;i<n.length&&n[i]<e;)i++,o++;return 0!=o&&(r&&(o%2?n.splice(i-o,o,e):n.splice(i-o,o)),!0)}for(;i<n.length&&n[i]<e;)i++,o++;return(t!=n[i-o]||1!=o)&&(r&&(o%2?n.splice(i-o,o,t):n.splice(i-o,o,t,e)),!0)}},PreciseShadowcasting:class extends z{compute(t,e,r,n){if(n(t,e,0,1),!this._lightPasses(t,e))return;let i,o,s,a,l,c,h=[];for(let u=1;u<=r;u++){let r=this._getCircle(t,e,u),f=r.length;for(let t=0;t<f;t++)if(i=r[t][0],o=r[t][1],a=[t?2*t-1:2*f-1,2*f],l=[2*t+1,2*f],s=!this._lightPasses(i,o),c=this._checkVisibility(a,l,s,h),c&&n(i,o,u,c),2==h.length&&0==h[0][0]&&h[1][0]==h[1][1])return}}_checkVisibility(t,e,r,n){if(t[0]>e[0]){return(this._checkVisibility(t,[t[1],t[1]],r,n)+this._checkVisibility([0,1],e,r,n))/2}let i=0,o=!1;for(;i<n.length;){let e=n[i],r=e[0]*t[1]-t[0]*e[1];if(r>=0){0!=r||i%2||(o=!0);break}i++}let s=n.length,a=!1;for(;s--;){let t=n[s],r=e[0]*t[1]-t[0]*e[1];if(r>=0){0==r&&s%2&&(a=!0);break}}let l,c=!0;if((i==s&&(o||a)||o&&a&&i+1==s&&s%2||i>s&&i%2)&&(c=!1),!c)return 0;let h=s-i+1;if(h%2)if(i%2){let t=n[i];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),r&&n.splice(i,h,e)}else{let e=n[s];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),r&&n.splice(i,h,t)}else{if(!(i%2))return r&&n.splice(i,h,t,e),1;{let t=n[i],e=n[s];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),r&&n.splice(i,h)}}return l/((e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]))}},RecursiveShadowcasting:class extends z{compute(t,e,r,n){n(t,e,0,1);for(let i=0;i<H.length;i++)this._renderOctant(t,e,H[i],r,n)}compute180(t,e,r,n,i){i(t,e,0,1);let o=(n-1+8)%8,s=(n-2+8)%8,a=(n+1+8)%8;this._renderOctant(t,e,H[s],r,i),this._renderOctant(t,e,H[o],r,i),this._renderOctant(t,e,H[n],r,i),this._renderOctant(t,e,H[a],r,i)}compute90(t,e,r,n,i){i(t,e,0,1);let o=(n-1+8)%8;this._renderOctant(t,e,H[n],r,i),this._renderOctant(t,e,H[o],r,i)}_renderOctant(t,e,r,n,i){this._castVisibility(t,e,1,1,0,n+1,r[0],r[1],r[2],r[3],i)}_castVisibility(t,e,r,n,i,o,s,a,l,c,h){if(!(n<i))for(let u=r;u<=o;u++){let r=-u-1,f=-u,d=!1,_=0;for(;r<=0;){r+=1;let p=t+r*s+f*a,g=e+r*l+f*c,m=(r-.5)/(f+.5),v=(r+.5)/(f-.5);if(!(v>n)){if(m<i)break;if(r*r+f*f<o*o&&h(p,g,u,1),d){if(!this._lightPasses(p,g)){_=v;continue}d=!1,n=_}else!this._lightPasses(p,g)&&u<o&&(d=!0,this._castVisibility(t,e,u+1,n,m,o,s,a,l,c,h),_=v)}}if(d)break}}}};class Y{constructor(t=P,e=V){this._width=t,this._height=e}_fillMap(t){let e=[];for(let r=0;r<this._width;r++){e.push([]);for(let n=0;n<this._height;n++)e[r].push(t)}return e}}class B extends Y{constructor(t,e){super(t,e),this._rooms=[],this._corridors=[]}getRooms(){return this._rooms}getCorridors(){return this._corridors}}class G{}class q extends G{constructor(t,e,r,n,i,o){super(),this._x1=t,this._y1=e,this._x2=r,this._y2=n,this._doors={},void 0!==i&&void 0!==o&&this.addDoor(i,o)}static createRandomAt(t,e,r,n,i){let o=i.roomWidth[0],s=i.roomWidth[1],a=c.a.getUniformInt(o,s);o=i.roomHeight[0],s=i.roomHeight[1];let l=c.a.getUniformInt(o,s);if(1==r){let r=e-Math.floor(c.a.getUniform()*l);return new this(t+1,r,t+a,r+l-1,t,e)}if(-1==r){let r=e-Math.floor(c.a.getUniform()*l);return new this(t-a,r,t-1,r+l-1,t,e)}if(1==n){let r=t-Math.floor(c.a.getUniform()*a);return new this(r,e+1,r+a-1,e+l,t,e)}if(-1==n){let r=t-Math.floor(c.a.getUniform()*a);return new this(r,e-l,r+a-1,e-1,t,e)}throw new Error("dx or dy must be 1 or -1")}static createRandomCenter(t,e,r){let n=r.roomWidth[0],i=r.roomWidth[1],o=c.a.getUniformInt(n,i);n=r.roomHeight[0],i=r.roomHeight[1];let s=c.a.getUniformInt(n,i),a=t-Math.floor(c.a.getUniform()*o),l=e-Math.floor(c.a.getUniform()*s);return new this(a,l,a+o-1,l+s-1)}static createRandom(t,e,r){let n=r.roomWidth[0],i=r.roomWidth[1],o=c.a.getUniformInt(n,i);n=r.roomHeight[0],i=r.roomHeight[1];let s=c.a.getUniformInt(n,i),a=t-o-1,l=e-s-1,h=1+Math.floor(c.a.getUniform()*a),u=1+Math.floor(c.a.getUniform()*l);return new this(h,u,h+o-1,u+s-1)}addDoor(t,e){return this._doors[t+","+e]=1,this}getDoors(t){for(let e in this._doors){let r=e.split(",");t(parseInt(r[0]),parseInt(r[1]))}return this}clearDoors(){return this._doors={},this}addDoors(t){let e=this._x1-1,r=this._x2+1,n=this._y1-1,i=this._y2+1;for(let o=e;o<=r;o++)for(let s=n;s<=i;s++)o!=e&&o!=r&&s!=n&&s!=i||t(o,s)||this.addDoor(o,s);return this}debug(){console.log("room",this._x1,this._y1,this._x2,this._y2)}isValid(t,e){let r=this._x1-1,n=this._x2+1,i=this._y1-1,o=this._y2+1;for(let s=r;s<=n;s++)for(let a=i;a<=o;a++)if(s==r||s==n||a==i||a==o){if(!t(s,a))return!1}else if(!e(s,a))return!1;return!0}create(t){let e=this._x1-1,r=this._x2+1,n=this._y1-1,i=this._y2+1,o=0;for(let s=e;s<=r;s++)for(let a=n;a<=i;a++)o=s+","+a in this._doors?2:s==e||s==r||a==n||a==i?1:0,t(s,a,o)}getCenter(){return[Math.round((this._x1+this._x2)/2),Math.round((this._y1+this._y2)/2)]}getLeft(){return this._x1}getRight(){return this._x2}getTop(){return this._y1}getBottom(){return this._y2}}class $ extends G{constructor(t,e,r,n){super(),this._startX=t,this._startY=e,this._endX=r,this._endY=n,this._endsWithAWall=!0}static createRandomAt(t,e,r,n,i){let o=i.corridorLength[0],s=i.corridorLength[1],a=c.a.getUniformInt(o,s);return new this(t,e,t+r*a,e+n*a)}debug(){console.log("corridor",this._startX,this._startY,this._endX,this._endY)}isValid(t,e){let r=this._startX,n=this._startY,i=this._endX-r,o=this._endY-n,s=1+Math.max(Math.abs(i),Math.abs(o));i&&(i/=Math.abs(i)),o&&(o/=Math.abs(o));let a=o,l=-i,c=!0;for(let h=0;h<s;h++){let u=r+h*i,f=n+h*o;if(e(u,f)||(c=!1),t(u+a,f+l)||(c=!1),t(u-a,f-l)||(c=!1),!c){s=h,this._endX=u-i,this._endY=f-o;break}}if(0==s)return!1;if(1==s&&t(this._endX+i,this._endY+o))return!1;let h=!t(this._endX+i+a,this._endY+o+l),u=!t(this._endX+i-a,this._endY+o-l);return this._endsWithAWall=t(this._endX+i,this._endY+o),!h&&!u||!this._endsWithAWall}create(t){let e=this._startX,r=this._startY,n=this._endX-e,i=this._endY-r,o=1+Math.max(Math.abs(n),Math.abs(i));n&&(n/=Math.abs(n)),i&&(i/=Math.abs(i));for(let s=0;s<o;s++){t(e+s*n,r+s*i,0)}return!0}createPriorityWalls(t){if(!this._endsWithAWall)return;let e=this._startX,r=this._startY,n=this._endX-e,i=this._endY-r;n&&(n/=Math.abs(n)),i&&(i/=Math.abs(i));let o=i,s=-n;t(this._endX+n,this._endY+i),t(this._endX+o,this._endY+s),t(this._endX-o,this._endY-s)}}const J={room:q,corridor:$};function Q(t,e,r){r[e[t+1]]=r[t],e[r[t]]=e[t+1],r[t]=t+1,e[t+1]=t}function Z(t,e,r){r[e[t]]=r[t],e[r[t]]=e[t],r[t]=t,e[t]=t}var tt={Arena:class extends Y{create(t){let e=this._width-1,r=this._height-1;for(let n=0;n<=e;n++)for(let i=0;i<=r;i++){t(n,i,n&&i&&n<e&&i<r?0:1)}return this}},Uniform:class extends B{constructor(t,e,r){super(t,e),this._options={roomWidth:[3,9],roomHeight:[3,5],roomDugPercentage:.1,timeLimit:1e3},Object.assign(this._options,r),this._map=[],this._dug=0,this._roomAttempts=20,this._corridorAttempts=20,this._connected=[],this._unconnected=[],this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this)}create(t){let e=Date.now();for(;;){if(Date.now()-e>this._options.timeLimit)return null;if(this._map=this._fillMap(1),this._dug=0,this._rooms=[],this._unconnected=[],this._generateRooms(),!(this._rooms.length<2)&&this._generateCorridors())break}if(t)for(let e=0;e<this._width;e++)for(let r=0;r<this._height;r++)t(e,r,this._map[e][r]);return this}_generateRooms(){let t,e=this._width-2,r=this._height-2;do{if(t=this._generateRoom(),this._dug/(e*r)>this._options.roomDugPercentage)break}while(t)}_generateRoom(){let t=0;for(;t<this._roomAttempts;){t++;let e=q.createRandom(this._width,this._height,this._options);if(e.isValid(this._isWallCallback,this._canBeDugCallback))return e.create(this._digCallback),this._rooms.push(e),e}return null}_generateCorridors(){let t=0;for(;t<this._corridorAttempts;){t++,this._corridors=[],this._map=this._fillMap(1);for(let t=0;t<this._rooms.length;t++){let e=this._rooms[t];e.clearDoors(),e.create(this._digCallback)}for(this._unconnected=c.a.shuffle(this._rooms.slice()),this._connected=[],this._unconnected.length&&this._connected.push(this._unconnected.pop());;){let t=c.a.getItem(this._connected);if(!t)break;let e=this._closestRoom(this._unconnected,t);if(!e)break;let r=this._closestRoom(this._connected,e);if(!r)break;if(!this._connectRooms(e,r))break;if(!this._unconnected.length)return!0}}return!1}_closestRoom(t,e){let r=1/0,n=e.getCenter(),i=null;for(let e=0;e<t.length;e++){let o=t[e],s=o.getCenter(),a=s[0]-n[0],l=s[1]-n[1],c=a*a+l*l;c<r&&(r=c,i=o)}return i}_connectRooms(t,e){let r,n,i,o,s,a,l,c=t.getCenter(),h=e.getCenter(),u=h[0]-c[0],f=h[1]-c[1];if(Math.abs(u)<Math.abs(f)?(i=f>0?2:0,o=(i+2)%4,s=e.getLeft(),a=e.getRight(),l=0):(i=u>0?1:3,o=(i+2)%4,s=e.getTop(),a=e.getBottom(),l=1),r=this._placeInWall(t,i),!r)return!1;if(r[l]>=s&&r[l]<=a){n=r.slice();let t=0;switch(o){case 0:t=e.getTop()-1;break;case 1:t=e.getRight()+1;break;case 2:t=e.getBottom()+1;break;case 3:t=e.getLeft()-1}n[(l+1)%2]=t,this._digLine([r,n])}else if(r[l]<s-1||r[l]>a+1){let t=r[l]-h[l],i=0;switch(o){case 0:case 1:i=t<0?3:1;break;case 2:case 3:i=t<0?1:3}if(o=(o+i)%4,n=this._placeInWall(e,o),!n)return!1;let s=[0,0];s[l]=r[l];let a=(l+1)%2;s[a]=n[a],this._digLine([r,s,n])}else{let t=(l+1)%2;if(n=this._placeInWall(e,o),!n)return!1;let i=Math.round((n[t]+r[t])/2),s=[0,0],a=[0,0];s[l]=r[l],s[t]=i,a[l]=n[l],a[t]=i,this._digLine([r,s,a,n])}return t.addDoor(r[0],r[1]),e.addDoor(n[0],n[1]),l=this._unconnected.indexOf(t),-1!=l&&(this._unconnected.splice(l,1),this._connected.push(t)),l=this._unconnected.indexOf(e),-1!=l&&(this._unconnected.splice(l,1),this._connected.push(e)),!0}_placeInWall(t,e){let r=[0,0],n=[0,0],i=0;switch(e){case 0:n=[1,0],r=[t.getLeft(),t.getTop()-1],i=t.getRight()-t.getLeft()+1;break;case 1:n=[0,1],r=[t.getRight()+1,t.getTop()],i=t.getBottom()-t.getTop()+1;break;case 2:n=[1,0],r=[t.getLeft(),t.getBottom()+1],i=t.getRight()-t.getLeft()+1;break;case 3:n=[0,1],r=[t.getLeft()-1,t.getTop()],i=t.getBottom()-t.getTop()+1}let o=[],s=-2;for(let t=0;t<i;t++){let e=r[0]+t*n[0],i=r[1]+t*n[1];o.push(null),1==this._map[e][i]?s!=t-1&&(o[t]=[e,i]):(s=t,t&&(o[t-1]=null))}for(let t=o.length-1;t>=0;t--)o[t]||o.splice(t,1);return o.length?c.a.getItem(o):null}_digLine(t){for(let e=1;e<t.length;e++){let r=t[e-1],n=t[e],i=new $(r[0],r[1],n[0],n[1]);i.create(this._digCallback),this._corridors.push(i)}}_digCallback(t,e,r){this._map[t][e]=r,0==r&&this._dug++}_isWallCallback(t,e){return!(t<0||e<0||t>=this._width||e>=this._height)&&1==this._map[t][e]}_canBeDugCallback(t,e){return!(t<1||e<1||t+1>=this._width||e+1>=this._height)&&1==this._map[t][e]}},Cellular:class extends Y{constructor(t,e,r={}){super(t,e),this._options={born:[5,6,7,8],survive:[4,5,6,7,8],topology:8},this.setOptions(r),this._dirs=R[this._options.topology],this._map=this._fillMap(0)}randomize(t){for(let e=0;e<this._width;e++)for(let r=0;r<this._height;r++)this._map[e][r]=c.a.getUniform()<t?1:0;return this}setOptions(t){Object.assign(this._options,t)}set(t,e,r){this._map[t][e]=r}create(t){let e=this._fillMap(0),r=this._options.born,n=this._options.survive;for(let t=0;t<this._height;t++){let i=1,o=0;6==this._options.topology&&(i=2,o=t%2);for(let s=o;s<this._width;s+=i){let i=this._map[s][t],o=this._getNeighbors(s,t);i&&-1!=n.indexOf(o)?e[s][t]=1:i||-1==r.indexOf(o)||(e[s][t]=1)}}this._map=e,t&&this._serviceCallback(t)}_serviceCallback(t){for(let e=0;e<this._height;e++){let r=1,n=0;6==this._options.topology&&(r=2,n=e%2);for(let i=n;i<this._width;i+=r)t(i,e,this._map[i][e])}}_getNeighbors(t,e){let r=0;for(let n=0;n<this._dirs.length;n++){let i=this._dirs[n],o=t+i[0],s=e+i[1];o<0||o>=this._width||s<0||s>=this._height||(r+=1==this._map[o][s]?1:0)}return r}connect(t,e,r){e||(e=0);let n=[],i={},o=1,s=[0,0];6==this._options.topology&&(o=2,s=[0,1]);for(let t=0;t<this._height;t++)for(let r=s[t%2];r<this._width;r+=o)if(this._freeSpace(r,t,e)){let e=[r,t];i[this._pointKey(e)]=e,n.push([r,t])}let a=n[c.a.getUniformInt(0,n.length-1)],l=this._pointKey(a),h={};for(h[l]=a,delete i[l],this._findConnected(h,i,[a],!1,e);Object.keys(i).length>0;){let t=this._getFromTo(h,i),n=t[0],o=t[1],s={};s[this._pointKey(n)]=n,this._findConnected(s,i,[n],!0,e),(6==this._options.topology?this._tunnelToConnected6:this._tunnelToConnected).call(this,o,n,h,i,e,r);for(let t in s){let r=s[t];this._map[r[0]][r[1]]=e,h[t]=r,delete i[t]}}t&&this._serviceCallback(t)}_getFromTo(t,e){let r,n=[0,0],i=[0,0],o=Object.keys(t),s=Object.keys(e);for(let a=0;a<5;a++){if(o.length<s.length){let r=o;i=t[r[c.a.getUniformInt(0,r.length-1)]],n=this._getClosest(i,e)}else{let r=s;n=e[r[c.a.getUniformInt(0,r.length-1)]],i=this._getClosest(n,t)}if(r=(n[0]-i[0])*(n[0]-i[0])+(n[1]-i[1])*(n[1]-i[1]),r<64)break}return[n,i]}_getClosest(t,e){let r=null,n=null;for(let i in e){let o=e[i],s=(o[0]-t[0])*(o[0]-t[0])+(o[1]-t[1])*(o[1]-t[1]);(null==n||s<n)&&(n=s,r=o)}return r}_findConnected(t,e,r,n,i){for(;r.length>0;){let o,s=r.splice(0,1)[0];o=6==this._options.topology?[[s[0]+2,s[1]],[s[0]+1,s[1]-1],[s[0]-1,s[1]-1],[s[0]-2,s[1]],[s[0]-1,s[1]+1],[s[0]+1,s[1]+1]]:[[s[0]+1,s[1]],[s[0]-1,s[1]],[s[0],s[1]+1],[s[0],s[1]-1]];for(let s=0;s<o.length;s++){let a=this._pointKey(o[s]);null==t[a]&&this._freeSpace(o[s][0],o[s][1],i)&&(t[a]=o[s],n||delete e[a],r.push(o[s]))}}}_tunnelToConnected(t,e,r,n,i,o){let s,a;e[0]<t[0]?(s=e,a=t):(s=t,a=e);for(let t=s[0];t<=a[0];t++){this._map[t][s[1]]=i;let e=[t,s[1]],o=this._pointKey(e);r[o]=e,delete n[o]}o&&s[0]<a[0]&&o(s,[a[0],s[1]]);let l=a[0];e[1]<t[1]?(s=e,a=t):(s=t,a=e);for(let t=s[1];t<a[1];t++){this._map[l][t]=i;let e=[l,t],o=this._pointKey(e);r[o]=e,delete n[o]}o&&s[1]<a[1]&&o([a[0],s[1]],[a[0],a[1]])}_tunnelToConnected6(t,e,r,n,i,o){let s,a;e[0]<t[0]?(s=e,a=t):(s=t,a=e);let l=s[0],c=s[1];for(;l!=a[0]||c!=a[1];){let t=2;c<a[1]?(c++,t=1):c>a[1]&&(c--,t=1),l<a[0]?l+=t:l>a[0]||a[1]%2?l-=t:l+=t,this._map[l][c]=i;let e=[l,c],o=this._pointKey(e);r[o]=e,delete n[o]}o&&o(e,t)}_freeSpace(t,e,r){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._map[t][e]==r}_pointKey(t){return t[0]+"."+t[1]}},Digger:class extends B{constructor(t,e,r={}){super(t,e),this._options=Object.assign({roomWidth:[3,9],roomHeight:[3,5],corridorLength:[3,10],dugPercentage:.2,timeLimit:1e3},r),this._features={room:4,corridor:4},this._map=[],this._featureAttempts=20,this._walls={},this._dug=0,this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this),this._priorityWallCallback=this._priorityWallCallback.bind(this)}create(t){this._rooms=[],this._corridors=[],this._map=this._fillMap(1),this._walls={},this._dug=0;let e=(this._width-2)*(this._height-2);this._firstRoom();let r,n=Date.now();do{if(r=0,Date.now()-n>this._options.timeLimit)break;let t=this._findWall();if(!t)break;let e=t.split(","),i=parseInt(e[0]),o=parseInt(e[1]),s=this._getDiggingDirection(i,o);if(!s)continue;let a=0;do{if(a++,this._tryFeature(i,o,s[0],s[1])){this._removeSurroundingWalls(i,o),this._removeSurroundingWalls(i-s[0],o-s[1]);break}}while(a<this._featureAttempts);for(let t in this._walls)this._walls[t]>1&&r++}while(this._dug/e<this._options.dugPercentage||r);if(this._addDoors(),t)for(let e=0;e<this._width;e++)for(let r=0;r<this._height;r++)t(e,r,this._map[e][r]);return this._walls={},this._map=[],this}_digCallback(t,e,r){0==r||2==r?(this._map[t][e]=0,this._dug++):this._walls[t+","+e]=1}_isWallCallback(t,e){return!(t<0||e<0||t>=this._width||e>=this._height)&&1==this._map[t][e]}_canBeDugCallback(t,e){return!(t<1||e<1||t+1>=this._width||e+1>=this._height)&&1==this._map[t][e]}_priorityWallCallback(t,e){this._walls[t+","+e]=2}_firstRoom(){let t=Math.floor(this._width/2),e=Math.floor(this._height/2),r=q.createRandomCenter(t,e,this._options);this._rooms.push(r),r.create(this._digCallback)}_findWall(){let t=[],e=[];for(let r in this._walls){2==this._walls[r]?e.push(r):t.push(r)}let r=e.length?e:t;if(!r.length)return null;let n=c.a.getItem(r.sort());return delete this._walls[n],n}_tryFeature(t,e,r,n){let i=c.a.getWeightedValue(this._features),o=J[i].createRandomAt(t,e,r,n,this._options);return!!o.isValid(this._isWallCallback,this._canBeDugCallback)&&(o.create(this._digCallback),o instanceof q&&this._rooms.push(o),o instanceof $&&(o.createPriorityWalls(this._priorityWallCallback),this._corridors.push(o)),!0)}_removeSurroundingWalls(t,e){let r=R[4];for(let n=0;n<r.length;n++){let i=r[n],o=t+i[0],s=e+i[1];delete this._walls[o+","+s],o=t+2*i[0],s=e+2*i[1],delete this._walls[o+","+s]}}_getDiggingDirection(t,e){if(t<=0||e<=0||t>=this._width-1||e>=this._height-1)return null;let r=null,n=R[4];for(let i=0;i<n.length;i++){let o=n[i],s=t+o[0],a=e+o[1];if(!this._map[s][a]){if(r)return null;r=o}}return r?[-r[0],-r[1]]:null}_addDoors(){let t=this._map;function e(e,r){return 1==t[e][r]}for(let t=0;t<this._rooms.length;t++){let r=this._rooms[t];r.clearDoors(),r.addDoors(e)}}},EllerMaze:class extends Y{create(t){let e,r=this._fillMap(1),n=Math.ceil((this._width-2)/2),i=[],o=[];for(let t=0;t<n;t++)i.push(t),o.push(t);for(i.push(n-1),e=1;e+3<this._height;e+=2)for(let t=0;t<n;t++){let n=2*t+1,s=e;r[n][s]=0,t!=i[t+1]&&c.a.getUniform()>9/24&&(Q(t,i,o),r[n+1][s]=0),t!=i[t]&&c.a.getUniform()>9/24?Z(t,i,o):r[n][s+1]=0}for(let t=0;t<n;t++){let n=2*t+1,s=e;r[n][s]=0,t!=i[t+1]&&(t==i[t]||c.a.getUniform()>9/24)&&(Q(t,i,o),r[n+1][s]=0),Z(t,i,o)}for(let e=0;e<this._width;e++)for(let n=0;n<this._height;n++)t(e,n,r[e][n]);return this}},DividedMaze:class extends Y{constructor(){super(...arguments),this._stack=[],this._map=[]}create(t){let e=this._width,r=this._height;this._map=[];for(let t=0;t<e;t++){this._map.push([]);for(let n=0;n<r;n++){let i=0==t||0==n||t+1==e||n+1==r;this._map[t].push(i?1:0)}}this._stack=[[1,1,e-2,r-2]],this._process();for(let n=0;n<e;n++)for(let e=0;e<r;e++)t(n,e,this._map[n][e]);return this._map=[],this}_process(){for(;this._stack.length;){let t=this._stack.shift();this._partitionRoom(t)}}_partitionRoom(t){let e=[],r=[];for(let r=t[0]+1;r<t[2];r++){let n=this._map[r][t[1]-1],i=this._map[r][t[3]+1];!n||!i||r%2||e.push(r)}for(let e=t[1]+1;e<t[3];e++){let n=this._map[t[0]-1][e],i=this._map[t[2]+1][e];!n||!i||e%2||r.push(e)}if(!e.length||!r.length)return;let n=c.a.getItem(e),i=c.a.getItem(r);this._map[n][i]=1;let o=[],s=[];o.push(s);for(let e=t[0];e<n;e++)this._map[e][i]=1,s.push([e,i]);s=[],o.push(s);for(let e=n+1;e<=t[2];e++)this._map[e][i]=1,s.push([e,i]);s=[],o.push(s);for(let e=t[1];e<i;e++)this._map[n][e]=1,s.push([n,e]);s=[],o.push(s);for(let e=i+1;e<=t[3];e++)this._map[n][e]=1,s.push([n,e]);let a=c.a.getItem(o);for(let t=0;t<o.length;t++){let e=o[t];if(e==a)continue;let r=c.a.getItem(e);this._map[r[0]][r[1]]=0}this._stack.push([t[0],t[1],n-1,i-1]),this._stack.push([n+1,t[1],t[2],i-1]),this._stack.push([t[0],i+1,n-1,t[3]]),this._stack.push([n+1,i+1,t[2],t[3]])}},IceyMaze:class extends Y{constructor(t,e,r=0){super(t,e),this._regularity=r,this._map=[]}create(t){let e=this._width,r=this._height,n=this._fillMap(1);e-=e%2?1:2,r-=r%2?1:2;let i=0,o=0,s=0,a=0,l=0,h=!1,u=[[0,0],[0,0],[0,0],[0,0]];do{if(i=1+2*Math.floor(c.a.getUniform()*(e-1)/2),o=1+2*Math.floor(c.a.getUniform()*(r-1)/2),l||(n[i][o]=0),!n[i][o]){this._randomize(u);do{0==Math.floor(c.a.getUniform()*(this._regularity+1))&&this._randomize(u),h=!0;for(let t=0;t<4;t++)if(s=i+2*u[t][0],a=o+2*u[t][1],this._isFree(n,s,a,e,r)){n[s][a]=0,n[i+u[t][0]][o+u[t][1]]=0,i=s,o=a,h=!1,l++;break}}while(!h)}}while(l+1<e*r/4);for(let e=0;e<this._width;e++)for(let r=0;r<this._height;r++)t(e,r,n[e][r]);return this._map=[],this}_randomize(t){for(let e=0;e<4;e++)t[e][0]=0,t[e][1]=0;switch(Math.floor(4*c.a.getUniform())){case 0:t[0][0]=-1,t[1][0]=1,t[2][1]=-1,t[3][1]=1;break;case 1:t[3][0]=-1,t[2][0]=1,t[1][1]=-1,t[0][1]=1;break;case 2:t[2][0]=-1,t[3][0]=1,t[0][1]=-1,t[1][1]=1;break;case 3:t[1][0]=-1,t[0][0]=1,t[3][1]=-1,t[2][1]=1}}_isFree(t,e,r,n,i){return!(e<1||r<1||e>=n||r>=i)&&t[e][r]}},Rogue:class extends Y{constructor(t,e,r){super(t,e),this.map=[],this.rooms=[],this.connectedCells=[],(r=Object.assign({cellWidth:3,cellHeight:3},r)).hasOwnProperty("roomWidth")||(r.roomWidth=this._calculateRoomSize(this._width,r.cellWidth)),r.hasOwnProperty("roomHeight")||(r.roomHeight=this._calculateRoomSize(this._height,r.cellHeight)),this._options=r}create(t){if(this.map=this._fillMap(1),this.rooms=[],this.connectedCells=[],this._initRooms(),this._connectRooms(),this._connectUnconnectedRooms(),this._createRandomRoomConnections(),this._createRooms(),this._createCorridors(),t)for(let e=0;e<this._width;e++)for(let r=0;r<this._height;r++)t(e,r,this.map[e][r]);return this}_calculateRoomSize(t,e){let r=Math.floor(t/e*.8),n=Math.floor(t/e*.25);return n<2&&(n=2),r<2&&(r=2),[n,r]}_initRooms(){for(let t=0;t<this._options.cellWidth;t++){this.rooms.push([]);for(let e=0;e<this._options.cellHeight;e++)this.rooms[t].push({x:0,y:0,width:0,height:0,connections:[],cellx:t,celly:e})}}_connectRooms(){let t,e,r,n,i,o,s=c.a.getUniformInt(0,this._options.cellWidth-1),a=c.a.getUniformInt(0,this._options.cellHeight-1),l=!1;do{o=[0,2,4,6],o=c.a.shuffle(o);do{if(l=!1,t=o.pop(),e=s+R[8][t][0],r=a+R[8][t][1],!(e<0||e>=this._options.cellWidth||r<0||r>=this._options.cellHeight)){if(n=this.rooms[s][a],n.connections.length>0&&n.connections[0][0]==e&&n.connections[0][1]==r)break;i=this.rooms[e][r],0==i.connections.length&&(i.connections.push([s,a]),this.connectedCells.push([e,r]),s=e,a=r,l=!0)}}while(o.length>0&&0==l)}while(o.length>0)}_connectUnconnectedRooms(){let t,e,r,n=this._options.cellWidth,i=this._options.cellHeight;this.connectedCells=c.a.shuffle(this.connectedCells);for(let o=0;o<this._options.cellWidth;o++)for(let s=0;s<this._options.cellHeight;s++)if(t=this.rooms[o][s],0==t.connections.length){let a=[0,2,4,6];a=c.a.shuffle(a),r=!1;do{let t=a.pop(),l=o+R[8][t][0],c=s+R[8][t][1];if(!(l<0||l>=n||c<0||c>=i)){if(e=this.rooms[l][c],r=!0,0==e.connections.length)break;for(let t=0;t<e.connections.length;t++)if(e.connections[t][0]==o&&e.connections[t][1]==s){r=!1;break}if(r)break}}while(a.length);r?t.connections.push([e.cellx,e.celly]):console.log("-- Unable to connect room.")}}_createRandomRoomConnections(){}_createRooms(){let t,e,r,n,i,o=this._width,s=this._height,a=this._options.cellWidth,l=this._options.cellHeight,h=Math.floor(this._width/a),u=Math.floor(this._height/l),f=this._options.roomWidth,d=this._options.roomHeight;for(let _=0;_<a;_++)for(let a=0;a<l;a++){if(r=h*_,n=u*a,0==r&&(r=1),0==n&&(n=1),t=c.a.getUniformInt(f[0],f[1]),e=c.a.getUniformInt(d[0],d[1]),a>0)for(i=this.rooms[_][a-1];n-(i.y+i.height)<3;)n++;if(_>0)for(i=this.rooms[_-1][a];r-(i.x+i.width)<3;)r++;let l=Math.round(c.a.getUniformInt(0,h-t)/2),p=Math.round(c.a.getUniformInt(0,u-e)/2);for(;r+l+t>=o;)l?l--:t--;for(;n+p+e>=s;)p?p--:e--;r+=l,n+=p,this.rooms[_][a].x=r,this.rooms[_][a].y=n,this.rooms[_][a].width=t,this.rooms[_][a].height=e;for(let i=r;i<r+t;i++)for(let t=n;t<n+e;t++)this.map[i][t]=0}}_getWallPosition(t,e){let r,n,i;return 1==e||3==e?(r=c.a.getUniformInt(t.x+1,t.x+t.width-2),1==e?(n=t.y-2,i=n+1):(n=t.y+t.height+1,i=n-1),this.map[r][i]=0):(n=c.a.getUniformInt(t.y+1,t.y+t.height-2),2==e?(r=t.x+t.width+1,i=r-1):(r=t.x-2,i=r+1),this.map[i][n]=0),[r,n]}_drawCorridor(t,e){let r,n,i,o,s=e[0]-t[0],a=e[1]-t[1],l=t[0],h=t[1],u=[],f=Math.abs(s),d=Math.abs(a),_=c.a.getUniform(),p=_,g=1-_;for(n=s>0?2:6,i=a>0?4:0,f<d?(r=Math.ceil(d*p),u.push([i,r]),u.push([n,f]),r=Math.floor(d*g),u.push([i,r])):(r=Math.ceil(f*p),u.push([n,r]),u.push([i,d]),r=Math.floor(f*g),u.push([n,r])),this.map[l][h]=0;u.length>0;)for(o=u.pop();o[1]>0;)l+=R[8][o[0]][0],h+=R[8][o[0]][1],this.map[l][h]=0,o[1]=o[1]-1}_createCorridors(){let t,e,r,n,i,o=this._options.cellWidth,s=this._options.cellHeight;for(let a=0;a<o;a++)for(let o=0;o<s;o++){t=this.rooms[a][o];for(let o=0;o<t.connections.length;o++)e=t.connections[o],r=this.rooms[e[0]][e[1]],r.cellx>t.cellx?(n=2,i=4):r.cellx<t.cellx?(n=4,i=2):r.celly>t.celly?(n=3,i=1):(n=1,i=3),this._drawCorridor(this._getWallPosition(t,n),this._getWallPosition(r,i))}}}};const et=.5*(Math.sqrt(3)-1),rt=(3-Math.sqrt(3))/6;var nt={Simplex:class extends class{}{constructor(t=256){super(),this._gradients=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]];let e=[];for(let r=0;r<t;r++)e.push(r);e=c.a.shuffle(e),this._perms=[],this._indexes=[];for(let r=0;r<2*t;r++)this._perms.push(e[r%t]),this._indexes.push(this._perms[r]%this._gradients.length)}get(t,e){let r,n,i,o=this._perms,s=this._indexes,a=o.length/2,l=0,c=0,h=0,u=(t+e)*et,d=Math.floor(t+u),_=Math.floor(e+u),p=(d+_)*rt,g=t-(d-p),m=e-(_-p);g>m?(n=1,i=0):(n=0,i=1);let v=g-n+rt,y=m-i+rt,b=g-1+2*rt,w=m-1+2*rt,x=Object(f.mod)(d,a),E=Object(f.mod)(_,a),S=.5-g*g-m*m;if(S>=0){S*=S,r=s[x+o[E]];let t=this._gradients[r];l=S*S*(t[0]*g+t[1]*m)}let k=.5-v*v-y*y;if(k>=0){k*=k,r=s[x+n+o[E+i]];let t=this._gradients[r];c=k*k*(t[0]*v+t[1]*y)}let T=.5-b*b-w*w;if(T>=0){T*=T,r=s[x+1+o[E+1]];let t=this._gradients[r];h=T*T*(t[0]*b+t[1]*w)}return 70*(l+c+h)}}};class it{constructor(t,e,r,n={}){this._toX=t,this._toY=e,this._passableCallback=r,this._options=Object.assign({topology:8},n),this._dirs=R[this._options.topology],8==this._options.topology&&(this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]])}_getNeighbors(t,e){let r=[];for(let n=0;n<this._dirs.length;n++){let i=this._dirs[n],o=t+i[0],s=e+i[1];this._passableCallback(o,s)&&r.push([o,s])}return r}}var ot={Dijkstra:class extends it{constructor(t,e,r,n){super(t,e,r,n),this._computed={},this._todo=[],this._add(t,e,null)}compute(t,e,r){let n=t+","+e;if(n in this._computed||this._compute(t,e),!(n in this._computed))return;let i=this._computed[n];for(;i;)r(i.x,i.y),i=i.prev}_compute(t,e){for(;this._todo.length;){let r=this._todo.shift();if(r.x==t&&r.y==e)return;let n=this._getNeighbors(r.x,r.y);for(let t=0;t<n.length;t++){let e=n[t],i=e[0],o=e[1];i+","+o in this._computed||this._add(i,o,r)}}}_add(t,e,r){let n={x:t,y:e,prev:r};this._computed[t+","+e]=n,this._todo.push(n)}},AStar:class extends it{constructor(t,e,r,n={}){super(t,e,r,n),this._todo=[],this._done={}}compute(t,e,r){for(this._todo=[],this._done={},this._fromX=t,this._fromY=e,this._add(this._toX,this._toY,null);this._todo.length;){let r=this._todo.shift(),n=r.x+","+r.y;if(n in this._done)continue;if(this._done[n]=r,r.x==t&&r.y==e)break;let i=this._getNeighbors(r.x,r.y);for(let t=0;t<i.length;t++){let e=i[t],n=e[0],o=e[1];n+","+o in this._done||this._add(n,o,r)}}let n=this._done[t+","+e];if(n)for(;n;)r(n.x,n.y),n=n.prev}_add(t,e,r){let n=this._distance(t,e),i={x:t,y:e,prev:r,g:r?r.g+1:0,h:n},o=i.g+i.h;for(let t=0;t<this._todo.length;t++){let e=this._todo[t],r=e.g+e.h;if(o<r||o==r&&n<e.h)return void this._todo.splice(t,0,i)}this._todo.push(i)}_distance(t,e){switch(this._options.topology){case 4:return Math.abs(t-this._fromX)+Math.abs(e-this._fromY);case 6:let r=Math.abs(t-this._fromX),n=Math.abs(e-this._fromY);return n+Math.max(0,(r-n)/2);case 8:return Math.max(Math.abs(t-this._fromX),Math.abs(e-this._fromY))}}}};class st{constructor(t){this._scheduler=t,this._lock=1}start(){return this.unlock()}lock(){return this._lock++,this}unlock(){if(!this._lock)throw new Error("Cannot unlock unlocked engine");for(this._lock--;!this._lock;){let t=this._scheduler.next();if(!t)return this.lock();let e=t.act();e&&e.then&&(this.lock(),e.then(this.unlock.bind(this)))}return this}}class at{constructor(t,e={}){this._reflectivityCallback=t,this._options={},e=Object.assign({passes:1,emissionThreshold:100,range:10},e),this._lights={},this._reflectivityCache={},this._fovCache={},this.setOptions(e)}setOptions(t){return Object.assign(this._options,t),t&&t.range&&this.reset(),this}setFOV(t){return this._fov=t,this._fovCache={},this}setLight(t,e,r){let n=t+","+e;return r?this._lights[n]="string"==typeof r?g.fromString(r):r:delete this._lights[n],this}clearLights(){this._lights={}}reset(){return this._reflectivityCache={},this._fovCache={},this}compute(t){let e={},r={},n={};for(let t in this._lights){let e=this._lights[t];r[t]=[0,0,0],g.add_(r[t],e)}for(let t=0;t<this._options.passes;t++)this._emitLight(r,n,e),t+1!=this._options.passes&&(r=this._computeEmitters(n,e));for(let e in n){let r=e.split(",");t(parseInt(r[0]),parseInt(r[1]),n[e])}return this}_emitLight(t,e,r){for(let n in t){let i=n.split(","),o=parseInt(i[0]),s=parseInt(i[1]);this._emitLightFromCell(o,s,t[n],e),r[n]=1}return this}_computeEmitters(t,e){let r={};for(let n in t){if(n in e)continue;let i,o=t[n];if(n in this._reflectivityCache)i=this._reflectivityCache[n];else{let t=n.split(","),e=parseInt(t[0]),r=parseInt(t[1]);i=this._reflectivityCallback(e,r),this._reflectivityCache[n]=i}if(0==i)continue;let s=[0,0,0],a=0;for(let t=0;t<3;t++){let e=Math.round(o[t]*i);s[t]=e,a+=e}a>this._options.emissionThreshold&&(r[n]=s)}return r}_emitLightFromCell(t,e,r,n){let i,o=t+","+e;i=o in this._fovCache?this._fovCache[o]:this._updateFOV(t,e);for(let t in i){let e,o=i[t];t in n?e=n[t]:(e=[0,0,0],n[t]=e);for(let t=0;t<3;t++)e[t]+=Math.round(r[t]*o)}return this}_updateFOV(t,e){let r=t+","+e,n={};this._fovCache[r]=n;let i=this._options.range;return this._fov.compute(t,e,i,function(t,e,r,o){let s=o*(1-r/i);0!=s&&(n[t+","+e]=s)}.bind(this)),n}}const lt=f,ct=g,ht=n;var ut=r(11),ft=r.n(ut),dt=r(8),_t=function(){return Math.random().toString(36).substring(7).split("").join(".")},pt={INIT:"@@redux/INIT"+_t(),REPLACE:"@@redux/REPLACE"+_t(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+_t()}};function gt(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function mt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vt(t,e){var r=Object.keys(t);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(t)),e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r}function yt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?vt(r,!0).forEach((function(e){mt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vt(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function bt(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}var wt=r(12),xt=function(t){return"@@redux-saga/"+t},Et=xt("CANCEL_PROMISE"),St=xt("CHANNEL_END"),kt=xt("IO"),Tt=xt("MATCH"),Ct=xt("MULTICAST"),Ot=xt("SAGA_ACTION"),At=xt("SELF_CANCELLATION"),Mt=xt("TASK"),Kt=xt("TASK_CANCEL"),Pt=xt("TERMINATE"),Vt=xt("LOCATION");function Rt(){return(Rt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var Lt=function(t){return null==t},jt=function(t){return null!=t},Nt=function(t){return"function"==typeof t},Dt=function(t){return"string"==typeof t},It=Array.isArray,Ut=function(t){return t&&Nt(t.then)},Ft=function(t){return t&&Nt(t.next)&&Nt(t.throw)},Wt=function t(e){return e&&(Dt(e)||Xt(e)||Nt(e)||It(e)&&e.every(t))},zt=function(t){return t&&Nt(t.take)&&Nt(t.close)},Ht=function(t){return Nt(t)&&t.hasOwnProperty("toString")},Xt=function(t){return Boolean(t)&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype};var Yt=function(t){return function(){return t}}(!0),Bt=function(){};var Gt=function(t){return t};"function"==typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator;var qt=function(t,e){Rt(t,e),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach((function(r){t[r]=e[r]}))};function $t(t,e){var r=t.indexOf(e);r>=0&&t.splice(r,1)}function Jt(t){var e=!1;return function(){e||(e=!0,t())}}var Qt=function(t){throw t},Zt=function(t){return{value:t,done:!0}};function te(t,e,r){void 0===e&&(e=Qt),void 0===r&&(r="iterator");var n={meta:{name:r},next:t,throw:e,return:Zt,isSagaIterator:!0};return"undefined"!=typeof Symbol&&(n[Symbol.iterator]=function(){return n}),n}function ee(t,e){var r=e.sagaStack;console.error(t),console.error(r)}var re=function(t){return Array.apply(null,new Array(t))},ne=function(t){return function(e){return t(Object.defineProperty(e,Ot,{value:!0}))}},ie=function(t){return t===Pt},oe=function(t){return t===Kt},se=function(t){return ie(t)||oe(t)};function ae(t,e){var r=Object.keys(t),n=r.length;var i,o=0,s=It(t)?re(n):{},a={};return r.forEach((function(t){var r=function(r,a){i||(a||se(r)?(e.cancel(),e(r,a)):(s[t]=r,++o===n&&(i=!0,e(s))))};r.cancel=Bt,a[t]=r})),e.cancel=function(){i||(i=!0,r.forEach((function(t){return a[t].cancel()})))},a}function le(t){return{name:t.name||"anonymous",location:ce(t)}}function ce(t){return t[Vt]}function he(t,e){void 0===t&&(t=10);var r=new Array(t),n=0,i=0,o=0,s=function(e){r[i]=e,i=(i+1)%t,n++},a=function(){if(0!=n){var e=r[o];return r[o]=null,n--,o=(o+1)%t,e}},l=function(){for(var t=[];n;)t.push(a());return t};return{isEmpty:function(){return 0==n},put:function(a){var c;if(n<t)s(a);else switch(e){case 1:throw new Error("Channel's Buffer overflow!");case 3:r[i]=a,o=i=(i+1)%t;break;case 4:c=2*t,r=l(),n=r.length,i=r.length,o=0,r.length=c,t=c,s(a)}},take:a,flush:l}}var ue=function(t){return he(t,4)},fe=function(t,e){var r;return(r={})[kt]=!0,r.combinator=!1,r.type=t,r.payload=e,r};function de(t,e){return void 0===t&&(t="*"),Wt(t)?fe("TAKE",{pattern:t}):zt(r=t)&&r[Ct]&&jt(e)&&Wt(e)?fe("TAKE",{channel:t,pattern:e}):zt(t)?fe("TAKE",{channel:t}):void 0;var r}function _e(t,e){var r,n=null;return Nt(t)?r=t:(It(t)?(n=t[0],r=t[1]):(n=t.context,r=t.fn),n&&Dt(r)&&Nt(n[r])&&(r=n[r])),{context:n,fn:r,args:e}}function pe(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return fe("FORK",_e(t,r))}function ge(){var t={};return t.promise=new Promise((function(e,r){t.resolve=e,t.reject=r})),t}var me=ge,ve=[],ye=0;function be(t){try{Ee(),t()}finally{Se()}}function we(t){ve.push(t),ye||(Ee(),ke())}function xe(t){try{return Ee(),t()}finally{ke()}}function Ee(){ye++}function Se(){ye--}function ke(){var t;for(Se();!ye&&void 0!==(t=ve.shift());)be(t)}var Te=function(t){return function(e){return t.some((function(t){return Ke(t)(e)}))}},Ce=function(t){return function(e){return t(e)}},Oe=function(t){return function(e){return e.type===String(t)}},Ae=function(t){return function(e){return e.type===t}},Me=function(){return Yt};function Ke(t){var e="*"===t?Me:Dt(t)?Oe:It(t)?Te:Ht(t)?Oe:Nt(t)?Ce:Xt(t)?Ae:null;if(null===e)throw new Error("invalid pattern: "+t);return e(t)}var Pe={type:St},Ve=function(t){return t&&t.type===St};function Re(t){void 0===t&&(t=ue());var e=!1,r=[];return{take:function(n){e&&t.isEmpty()?n(Pe):t.isEmpty()?(r.push(n),n.cancel=function(){$t(r,n)}):n(t.take())},put:function(n){if(!e){if(0===r.length)return t.put(n);r.shift()(n)}},flush:function(r){e&&t.isEmpty()?r(Pe):r(t.flush())},close:function(){if(!e){e=!0;var t=r;r=[];for(var n=0,i=t.length;n<i;n++){(0,t[n])(Pe)}}}}}function Le(){var t,e,r,n,i,o,s=(e=!1,n=r=[],i=function(){n===r&&(n=r.slice())},o=function(){e=!0;var t=r=n;n=[],t.forEach((function(t){t(Pe)}))},(t={})[Ct]=!0,t.put=function(t){if(!e)if(Ve(t))o();else for(var i=r=n,s=0,a=i.length;s<a;s++){var l=i[s];l[Tt](t)&&(l.cancel(),l(t))}},t.take=function(t,r){void 0===r&&(r=Me),e?t(Pe):(t[Tt]=r,i(),n.push(t),t.cancel=Jt((function(){i(),$t(n,t)})))},t.close=o,t),a=s.put;return s.put=function(t){t[Ot]?a(t):we((function(){a(t)}))},s}function je(t,e){var r=t[Et];Nt(r)&&(e.cancel=r),t.then(e,(function(t){e(t,!0)}))}var Ne,De=0,Ie=function(){return++De};function Ue(t){t.isRunning()&&t.cancel()}var Fe=((Ne={}).TAKE=function(t,e,r){var n=e.channel,i=void 0===n?t.channel:n,o=e.pattern,s=e.maybe,a=function(t){t instanceof Error?r(t,!0):!Ve(t)||s?r(t):r(Pt)};try{i.take(a,jt(o)?Ke(o):null)}catch(t){return void r(t,!0)}r.cancel=a.cancel},Ne.PUT=function(t,e,r){var n=e.channel,i=e.action,o=e.resolve;we((function(){var e;try{e=(n?n.put:t.dispatch)(i)}catch(t){return void r(t,!0)}o&&Ut(e)?je(e,r):r(e)}))},Ne.ALL=function(t,e,r,n){var i=n.digestEffect,o=De,s=Object.keys(e);if(0!==s.length){var a=ae(e,r);s.forEach((function(t){i(e[t],o,a[t],t)}))}else r(It(e)?[]:{})},Ne.RACE=function(t,e,r,n){var i=n.digestEffect,o=De,s=Object.keys(e),a=It(e)?re(s.length):{},l={},c=!1;s.forEach((function(t){var e=function(e,n){c||(n||se(e)?(r.cancel(),r(e,n)):(r.cancel(),c=!0,a[t]=e,r(a)))};e.cancel=Bt,l[t]=e})),r.cancel=function(){c||(c=!0,s.forEach((function(t){return l[t].cancel()})))},s.forEach((function(t){c||i(e[t],o,l[t],t)}))},Ne.CALL=function(t,e,r,n){var i=e.context,o=e.fn,s=e.args,a=n.task;try{var l=o.apply(i,s);if(Ut(l))return void je(l,r);if(Ft(l))return void qe(t,l,a.context,De,le(o),!1,r);r(l)}catch(t){r(t,!0)}},Ne.CPS=function(t,e,r){var n=e.context,i=e.fn,o=e.args;try{var s=function(t,e){Lt(t)?r(e):r(t,!0)};i.apply(n,o.concat(s)),s.cancel&&(r.cancel=s.cancel)}catch(t){r(t,!0)}},Ne.FORK=function(t,e,r,n){var i=e.context,o=e.fn,s=e.args,a=e.detached,l=n.task,c=function(t){var e=t.context,r=t.fn,n=t.args;try{var i=r.apply(e,n);if(Ft(i))return i;var o=!1;return te((function(t){return o?{value:t,done:!0}:(o=!0,{value:i,done:!Ut(i)})}))}catch(t){return te((function(){throw t}))}}({context:i,fn:o,args:s}),h=function(t,e){return t.isSagaIterator?{name:t.meta.name}:le(e)}(c,o);xe((function(){var e=qe(t,c,l.context,De,h,a,void 0);a?r(e):e.isRunning()?(l.queue.addTask(e),r(e)):e.isAborted()?l.queue.abort(e.error()):r(e)}))},Ne.JOIN=function(t,e,r,n){var i=n.task,o=function(t,e){if(t.isRunning()){var r={task:i,cb:e};e.cancel=function(){t.isRunning()&&$t(t.joiners,r)},t.joiners.push(r)}else t.isAborted()?e(t.error(),!0):e(t.result())};if(It(e)){if(0===e.length)return void r([]);var s=ae(e,r);e.forEach((function(t,e){o(t,s[e])}))}else o(e,r)},Ne.CANCEL=function(t,e,r,n){var i=n.task;e===At?Ue(i):It(e)?e.forEach(Ue):Ue(e),r()},Ne.SELECT=function(t,e,r){var n=e.selector,i=e.args;try{r(n.apply(void 0,[t.getState()].concat(i)))}catch(t){r(t,!0)}},Ne.ACTION_CHANNEL=function(t,e,r){var n=e.pattern,i=Re(e.buffer),o=Ke(n),s=function e(r){Ve(r)||t.channel.take(e,o),i.put(r)},a=i.close;i.close=function(){s.cancel(),a()},t.channel.take(s,o),r(i)},Ne.CANCELLED=function(t,e,r,n){r(n.task.isCancelled())},Ne.FLUSH=function(t,e,r){e.flush(r)},Ne.GET_CONTEXT=function(t,e,r,n){r(n.task.context[e])},Ne.SET_CONTEXT=function(t,e,r,n){var i=n.task;qt(i.context,e),r()},Ne);function We(t,e){return t+"?"+e}function ze(t){var e=t.name,r=t.location;return r?e+"  "+We(r.fileName,r.lineNumber):e}var He=null,Xe=[],Ye=function(){He=null,Xe.length=0},Be=function(){var t,e,r,n,i,o,s,a=Xe[0],l=Xe.slice(1),c=a.crashedEffect?(t=a.crashedEffect,(e=ce(t))?e.code+"  "+We(e.fileName,e.lineNumber):""):null;return["The above error occurred in task "+ze(a.meta)+(c?" \n when executing effect "+c:"")].concat(l.map((function(t){return"    created by "+ze(t.meta)})),[(r=Xe,n=function(t){return t.cancelledTasks},i=r,s=(o=[]).concat.apply(o,i.map(n)),s.length?["Tasks cancelled due to error:"].concat(s).join("\n"):"")]).join("\n")};function Ge(t,e,r,n,i,o,s){var a;void 0===s&&(s=Bt);var l,c,h=0,u=null,f=[],d=Object.create(r),_=function(t,e,r){var n,i=[],o=!1;function s(t){e(),l(),r(t,!0)}function a(e){i.push(e),e.cont=function(a,l){o||($t(i,e),e.cont=Bt,l?s(a):(e===t&&(n=a),i.length||(o=!0,r(n))))}}function l(){o||(o=!0,i.forEach((function(t){t.cont=Bt,t.cancel()})),i=[])}return a(t),{addTask:a,cancelAll:l,abort:s,getTasks:function(){return i}}}(e,(function(){f.push.apply(f,_.getTasks().map((function(t){return t.meta.name})))}),p);function p(e,r){if(r){if(h=2,(o={meta:i,cancelledTasks:f}).crashedEffect=He,Xe.push(o),g.isRoot){var n=Be();Ye(),t.onError(e,{sagaStack:n})}c=e,u&&u.reject(e)}else e===Kt?h=1:1!==h&&(h=3),l=e,u&&u.resolve(e);var o;g.cont(e,r),g.joiners.forEach((function(t){t.cb(e,r)})),g.joiners=null}var g=((a={})[Mt]=!0,a.id=n,a.meta=i,a.isRoot=o,a.context=d,a.joiners=[],a.queue=_,a.cancel=function(){0===h&&(h=1,_.cancelAll(),p(Kt,!1))},a.cont=s,a.end=p,a.setContext=function(t){qt(d,t)},a.toPromise=function(){return u||(u=me(),2===h?u.reject(c):0!==h&&u.resolve(l)),u.promise},a.isRunning=function(){return 0===h},a.isCancelled=function(){return 1===h||0===h&&1===e.status},a.isAborted=function(){return 2===h},a.result=function(){return l},a.error=function(){return c},a);return g}function qe(t,e,r,n,i,o,s){var a=t.finalizeRunEffect((function(e,r,n){if(Ut(e))je(e,n);else if(Ft(e))qe(t,e,c.context,r,i,!1,n);else if(e&&e[kt]){(0,Fe[e.type])(t,e.payload,n,h)}else n(e)}));u.cancel=Bt;var l={meta:i,cancel:function(){0===l.status&&(l.status=1,u(Kt))},status:0},c=Ge(t,l,r,n,i,o,s),h={task:c,digestEffect:f};return s&&(s.cancel=c.cancel),u(),c;function u(t,r){try{var i;r?(i=e.throw(t),Ye()):oe(t)?(l.status=1,u.cancel(),i=Nt(e.return)?e.return(Kt):{done:!0,value:Kt}):i=ie(t)?Nt(e.return)?e.return():{done:!0}:e.next(t),i.done?(1!==l.status&&(l.status=3),l.cont(i.value)):f(i.value,n,u)}catch(t){if(1===l.status)throw t;l.status=2,l.cont(t,!0)}}function f(e,r,n,i){void 0===i&&(i="");var o,s=Ie();function l(r,i){o||(o=!0,n.cancel=Bt,t.sagaMonitor&&(i?t.sagaMonitor.effectRejected(s,r):t.sagaMonitor.effectResolved(s,r)),i&&function(t){He=t}(e),n(r,i))}t.sagaMonitor&&t.sagaMonitor.effectTriggered({effectId:s,parentEffectId:r,label:i,effect:e}),l.cancel=Bt,n.cancel=function(){o||(o=!0,l.cancel(),l.cancel=Bt,t.sagaMonitor&&t.sagaMonitor.effectCancelled(s))},a(e,s,l)}}function $e(t,e){var r=t.channel,n=void 0===r?Le():r,i=t.dispatch,o=t.getState,s=t.context,a=void 0===s?{}:s,l=t.sagaMonitor,c=t.effectMiddlewares,h=t.onError,u=void 0===h?ee:h;for(var f=arguments.length,d=new Array(f>2?f-2:0),_=2;_<f;_++)d[_-2]=arguments[_];var p=e.apply(void 0,d);var g,m=Ie();if(l&&(l.rootSagaStarted=l.rootSagaStarted||Bt,l.effectTriggered=l.effectTriggered||Bt,l.effectResolved=l.effectResolved||Bt,l.effectRejected=l.effectRejected||Bt,l.effectCancelled=l.effectCancelled||Bt,l.actionDispatched=l.actionDispatched||Bt,l.rootSagaStarted({effectId:m,saga:e,args:d})),c){var v=bt.apply(void 0,c);g=function(t){return function(e,r,n){return v((function(e){return t(e,r,n)}))(e)}}}else g=Gt;var y={channel:n,dispatch:ne(i),getState:o,sagaMonitor:l,onError:u,finalizeRunEffect:g};return xe((function(){var t=qe(y,p,a,m,le(e),!0,void 0);return l&&l.effectResolved(m,t),t}))}var Je=function(t){var e,r=void 0===t?{}:t,n=r.context,i=void 0===n?{}:n,o=r.channel,s=void 0===o?Le():o,a=r.sagaMonitor,l=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(r,["context","channel","sagaMonitor"]);function c(t){var r=t.getState,n=t.dispatch;return e=$e.bind(null,Rt({},l,{context:i,channel:s,dispatch:n,getState:r,sagaMonitor:a})),function(t){return function(e){a&&a.actionDispatched&&a.actionDispatched(e);var r=t(e);return s.put(e),r}}}return c.run=function(){return e.apply(void 0,arguments)},c.setContext=function(t){qt(i,t)},c},Qe=r(14),Ze=r.n(Qe),tr=r(6),er=r.n(tr),rr=function(t){return{done:!0,value:t}},nr={};function ir(t){return zt(t)?"channel":Ht(t)?String(t):Nt(t)?t.name:String(t)}function or(t,e,r){var n,i,o,s=e;function a(e,r){if(s===nr)return rr(e);if(r&&!i)throw s=nr,r;n&&n(e);var a=r?t[i](r):t[s]();return s=a.nextState,o=a.effect,n=a.stateUpdater,i=a.errorState,s===nr?rr(e):o}return te(a,(function(t){return a(null,t)}),r)}function sr(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o,s={done:!1,value:de(t)},a=function(t){return{done:!1,value:pe.apply(void 0,[e].concat(n,[t]))}},l=function(t){return o=t};return or({q1:function(){return{nextState:"q2",effect:s,stateUpdater:l}},q2:function(){return{nextState:"q1",effect:a(o)}}},"q1","takeEvery("+ir(t)+", "+e.name+")")}function ar(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return pe.apply(void 0,[sr,t,e].concat(n))}var lr=function(){return document.querySelector(".main__log")},cr=function(t){var e=document.createElement("div");e.classList.add("main__log-row");var r=function(t){return"object"===er()(t)?JSON.stringify(t,void 0,2):t}(t);return e.innerHTML=r,e},hr=function(){for(var t=lr(),e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.map(cr);i.forEach((function(e){return t.appendChild(e)})),t.scrollTop=t.scrollHeight},ur=s.a.mark(_r),fr=s.a.mark(pr),dr=s.a.mark(gr);function _r(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"!==er()(t.message)||void 0===t.message.length){e.next=5;break}return e.next=3,hr.apply(void 0,Ze()(t.message));case 3:e.next=7;break;case 5:return e.next=7,hr(t.message);case 7:case"end":return e.stop()}}),ur)}function pr(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,void(lr().innerHTML="");case 2:case"end":return t.stop()}}),fr)}function gr(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ar("LOG_MESSAGE",_r);case 2:return t.next=4,ar("CLEAR_LOG",pr);case 4:case"end":return t.stop()}}),dr)}function mr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var vr=Je(),yr=[vr,Object(wt.createLogger)({collapsed:!0})],br={lastFoobar:void 0},wr={FOOBAR:function(t,e){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?mr(Object(r),!0).forEach((function(e){ft()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t,{lastFoobar:new Date})}},xr=function t(e,r,n){var i;if("function"==typeof r&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof r&&void 0===n&&(n=r,r=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(t)(e,r)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,s=r,a=[],l=a,c=!1;function h(){l===a&&(l=a.slice())}function u(){if(c)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return s}function f(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(c)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var e=!0;return h(),l.push(t),function(){if(e){if(c)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");e=!1,h();var r=l.indexOf(t);l.splice(r,1),a=null}}}function d(t){if(!gt(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,s=o(s,t)}finally{c=!1}for(var e=a=l,r=0;r<e.length;r++){(0,e[r])()}return t}function _(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");o=t,d({type:pt.REPLACE})}function p(){var t,e=f;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function r(){t.next&&t.next(u())}return r(),{unsubscribe:e(r)}}})[dt.a]=function(){return this},t}return d({type:pt.INIT}),(i={dispatch:d,subscribe:f,getState:u,replaceReducer:_})[dt.a]=p,i}((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:br,e=arguments.length>1?arguments[1]:void 0;return wr[e.type]?wr[e.type](t,e):t}),function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return function(){var r=t.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=e.map((function(t){return t(i)}));return yt({},r,{dispatch:n=bt.apply(void 0,o)(r.dispatch)})}}}.apply(void 0,yr));xr.log=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];xr.dispatch({type:"LOG_MESSAGE",message:e})},xr.clearLog=function(){return xr.dispatch({type:"CLEAR_LOG"})},vr.run(gr);var Er=xr,Sr=function(){var t=l()(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){t({x:10,y:10,char:"@",fg:"#fff",bg:"#000",draw:function(t){t.draw(this.x,this.y,this.char,this.fg,this.bg)},move:function(t,e){this.x+=t,this.y+=e}})})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),kr=new D({width:21,height:21,forceSquareRatio:!0}),Tr=void 0;Sr().then((function(t){return Tr=t}));var Cr=function(){var t=l()(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){document.querySelector(".main__canvas").appendChild(kr.getContainer()),t()})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Or=function(){var t=l()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t){var e=t.keyCode,r=0,n=0;[L.VK_A,L.VK_H,L.VK_LEFT].includes(e)&&(r-=1),[L.VK_S,L.VK_J,L.VK_DOWN].includes(e)&&(n+=1),[L.VK_D,L.VK_L,L.VK_RIGHT].includes(e)&&(r+=1),[L.VK_W,L.VK_K,L.VK_UP].includes(e)&&(n-=1),0===r&&0===n||(kr.clear(),Tr.move(r,n),Tr.draw(kr),Er.log("Moving: [x: ".concat(Tr.x,", y: ").concat(Tr.y,"]")))},document.body.addEventListener("keydown",e);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(function(){var t=l()(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Er.log("Setting up display..."),t.next=3,Cr();case 3:Or(),Er.log("Setting up player..."),Tr.draw(kr),Er.log("Done."),Er.clearLog();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()(),window.game=Er,window.ROT=i,window.display=kr}]);